
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://docs.pysmo.org/api/pysmo/tools/iccs/">
      
      
        <link rel="prev" href="../azdist/">
      
      
        <link rel="next" href="../noise/">
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.20">
    
    
      
        <title>iccs - pysmo</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.e53b48f4.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../../css/material.css">
    
      <link rel="stylesheet" href="../../../../css/mermaid.css">
    
      <link rel="stylesheet" href="../../../../css/mkdocstrings.css">
    
      <link rel="stylesheet" href="https://unpkg.com/katex@0/dist/katex.min.css">
    
      <link rel="stylesheet" href="../../../../termynal.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pysmo.tools.iccs" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="pysmo" class="md-header__button md-logo" aria-label="pysmo" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            pysmo
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              iccs
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="blue-grey"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue-grey" data-md-color-accent="blue-grey"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/pysmo/pysmo" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    pysmo/pysmo
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="pysmo" class="md-nav__button md-logo" aria-label="pysmo" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    pysmo
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/pysmo/pysmo" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    pysmo/pysmo
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../.." class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../first-steps/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    First steps
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            First steps
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../first-steps/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installing pysmo
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../first-steps/tutorial/tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../user-guide/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    User guide
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            User guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../user-guide/in-the-box/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    What is in the Box?
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../user-guide/types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Types
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../user-guide/classes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Classes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../user-guide/functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Functions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            API reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    pysmo
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            pysmo
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../classes/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    pysmo.classes
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            pysmo.classes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../functions/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    pysmo.functions
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            pysmo.functions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    pysmo.tools
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            pysmo.tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../azdist/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    azdist
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    iccs
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    iccs
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pysmo.tools.iccs--data-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      Data requirements
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pysmo.tools.iccs--execution-flow" class="md-nav__link">
    <span class="md-ellipsis">
      Execution flow
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pysmo.tools.iccs--operator-involvement" class="md-nav__link">
    <span class="md-ellipsis">
      Operator involvement
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCS" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ICCS
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ICCS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCS.cc_seismograms" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;cc_seismograms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCS.ccnorms" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;ccnorms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCS.min_ccnorm" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;min_ccnorm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCS.padded_seismograms" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;padded_seismograms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCS.padded_stack" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;padded_stack
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCS.plot_padding" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;plot_padding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCS.seismograms" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;seismograms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCS.stack" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;stack
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCS.taper_width" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;taper_width
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCS.window_post" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;window_post
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCS.window_pre" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;window_pre
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCS.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__call__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCS.validate_pick" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;validate_pick
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCS.validate_time_window" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;validate_time_window
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCSSeismogram" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ICCSSeismogram
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ICCSSeismogram">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCSSeismogram.begin_time" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;begin_time
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCSSeismogram.data" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCSSeismogram.delta" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;delta
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCSSeismogram.end_time" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;end_time
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCSSeismogram.flip" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;flip
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCSSeismogram.select" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;select
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCSSeismogram.t0" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;t0
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCSSeismogram.t1" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;t1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCSSeismogram.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__len__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.MiniICCSSeismogram" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MiniICCSSeismogram
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" MiniICCSSeismogram">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.MiniICCSSeismogram.begin_time" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;begin_time
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.MiniICCSSeismogram.data" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.MiniICCSSeismogram.delta" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;delta
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.MiniICCSSeismogram.end_time" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;end_time
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.MiniICCSSeismogram.flip" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;flip
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.MiniICCSSeismogram.select" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;select
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.MiniICCSSeismogram.t0" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;t0
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.MiniICCSSeismogram.t1" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;t1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.MiniICCSSeismogram.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__len__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.plot_seismograms" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;plot_seismograms
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.plot_stack" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;plot_stack
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.update_all_picks" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;update_all_picks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.update_min_ccnorm" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;update_min_ccnorm
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.update_pick" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;update_pick
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.update_timewindow" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;update_timewindow
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../noise/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    noise
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plotutils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    plotutils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../signal/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    signal
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../lib/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    pysmo.lib
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            pysmo.lib
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../developing/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Developing pysmo
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Developing pysmo
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../developing/developing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Development Environment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../developing/contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../contributors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributors
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Changelog
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pysmo.tools.iccs--data-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      Data requirements
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pysmo.tools.iccs--execution-flow" class="md-nav__link">
    <span class="md-ellipsis">
      Execution flow
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pysmo.tools.iccs--operator-involvement" class="md-nav__link">
    <span class="md-ellipsis">
      Operator involvement
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCS" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ICCS
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ICCS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCS.cc_seismograms" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;cc_seismograms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCS.ccnorms" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;ccnorms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCS.min_ccnorm" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;min_ccnorm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCS.padded_seismograms" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;padded_seismograms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCS.padded_stack" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;padded_stack
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCS.plot_padding" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;plot_padding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCS.seismograms" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;seismograms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCS.stack" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;stack
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCS.taper_width" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;taper_width
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCS.window_post" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;window_post
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCS.window_pre" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;window_pre
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCS.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__call__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCS.validate_pick" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;validate_pick
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCS.validate_time_window" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;validate_time_window
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCSSeismogram" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ICCSSeismogram
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ICCSSeismogram">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCSSeismogram.begin_time" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;begin_time
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCSSeismogram.data" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCSSeismogram.delta" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;delta
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCSSeismogram.end_time" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;end_time
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCSSeismogram.flip" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;flip
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCSSeismogram.select" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;select
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCSSeismogram.t0" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;t0
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCSSeismogram.t1" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;t1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.ICCSSeismogram.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__len__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.MiniICCSSeismogram" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MiniICCSSeismogram
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" MiniICCSSeismogram">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.MiniICCSSeismogram.begin_time" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;begin_time
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.MiniICCSSeismogram.data" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.MiniICCSSeismogram.delta" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;delta
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.MiniICCSSeismogram.end_time" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;end_time
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.MiniICCSSeismogram.flip" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;flip
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.MiniICCSSeismogram.select" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;select
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.MiniICCSSeismogram.t0" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;t0
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.MiniICCSSeismogram.t1" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;t1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.MiniICCSSeismogram.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__len__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.plot_seismograms" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;plot_seismograms
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.plot_stack" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;plot_stack
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.update_all_picks" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;update_all_picks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.update_min_ccnorm" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;update_min_ccnorm
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.update_pick" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;update_pick
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pysmo.tools.iccs.update_timewindow" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;update_timewindow
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/pysmo/pysmo/edit/master/docs/api/pysmo/tools/iccs.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/pysmo/pysmo/raw/master/docs/api/pysmo/tools/iccs.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<div class="doc doc-object doc-module">



<h1 id="pysmo.tools.iccs" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">pysmo.tools.iccs</span>


<a href="#pysmo.tools.iccs" class="headerlink" title="Permanent link">#</a></h1>

    <div class="doc doc-contents first">

        <p>Iterative Cross-Correlation and Stack (ICCS).</p>


<details class="warning" open>
  <summary>Warning</summary>
  <p>This module is being developed alongside a complete rewrite of
<a href="https://github.com/pysmo/aimbat">AIMBAT</a>. Expect major changes until
the rewrite is complete.</p>
</details>        <p>The ICCS<sup id="pysmo.tools.iccs--fnref:1"><a class="footnote-ref" href="#pysmo.tools.iccs--fn:1">1</a></sup> method is an iterative algorithm to rapidly determine the best
fitting delay times between an arbitrary number of seismograms with minimal
involvement by a human operator. Instead of looking at individual seismograms,
parameters are set that control the algorithm, which then iteratively aligns
seismograms, or discards them from futher consideration if they are of poor
quality.</p>
<p>The basic idea of ICCS, is that stacking all seismograms (aligned with respect
to an initial, and later improved, phase arrival pick) will lead to the
targeted phase arrival becoming visible in the stack. As the stack is generated
from all input seismograms, the phase arrival in the stack may be considered a
representation of the "best" mean arrival time. Each individual seismogram can
then be cross-correlated with the stack to determine a time shift that best
alligns them with the stack and thus each other.</p>
<p>The results of ICCS are are similar to those of the the MCCC<sup id="pysmo.tools.iccs--fnref:2"><a class="footnote-ref" href="#pysmo.tools.iccs--fn:2">2</a></sup> method, while
also requiring fewer cross-correlations to be computed (each individual
seismogram is only cross-correlated with the stack, whereas in MCCC all
seismograms are cross-correlated with each other). ICCS is therefore
particularly useful to perepare data for a successful MCCC run (e.g. if the
initial picks are calculated rather than hand picked).</p>
<h3 id="pysmo.tools.iccs--data-requirements">Data requirements<a class="headerlink" href="#pysmo.tools.iccs--data-requirements" title="Permanent link">#</a></h3>
<p>The <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-module&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-module-name&quot;&gt;pysmo.tools.iccs&lt;/span&gt;" href="#pysmo.tools.iccs"><code>iccs</code></a> module requires seismograms containing extra
attributes specific to the ICCS method. Hence it provides a protocol class
(<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ICCSSeismogram&lt;/span&gt;" href="#pysmo.tools.iccs.ICCSSeismogram"><code>ICCSSeismogram</code></a>) and corresponding Mini
class (<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;MiniICCSSeismogram&lt;/span&gt;" href="#pysmo.tools.iccs.MiniICCSSeismogram"><code>MiniICCSSeismogram</code></a>) for that
purpose. In addition to the common attributes of a
<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;Seismogram&lt;/span&gt;" href="../../../#pysmo.Seismogram"><code>Seismogram</code></a> in pysmo, the following parameters are
required:</p>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;t0&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-property&quot;&gt;&lt;code&gt;property&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-writable&quot;&gt;&lt;code&gt;writable&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#pysmo.tools.iccs.ICCSSeismogram.t0"><code>t0</code></a></td>
<td>Initial pick (typically     computed). Serves as input only when <code>t1</code> is not set.</td>
</tr>
<tr>
<td><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;t1&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-property&quot;&gt;&lt;code&gt;property&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-writable&quot;&gt;&lt;code&gt;writable&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#pysmo.tools.iccs.ICCSSeismogram.t1"><code>t1</code></a></td>
<td>Improved pick.     Serves as both input (if not <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/constants.html#None"><code>None</code></a>) and output (always) when     <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;__call__&lt;/span&gt;" href="#pysmo.tools.iccs.ICCS.__call__">running</a> the ICCS algorithm. It should     be set to <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/constants.html#None"><code>None</code></a> initially.</td>
</tr>
<tr>
<td><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;select&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-property&quot;&gt;&lt;code&gt;property&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-writable&quot;&gt;&lt;code&gt;writable&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#pysmo.tools.iccs.ICCSSeismogram.select"><code>select</code></a></td>
<td>Determines if a      seismogram is used for the stack, and should therefore be <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/constants.html#True"><code>True</code></a>     initially. It is set to <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/constants.html#False"><code>False</code></a> for poor quality seismograms     automatically during a run if <code>autoselect</code> is <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/constants.html#True"><code>True</code></a>. Note that     this flag does <em>not</em> exclude a seismogram from being cross-correlated with     the stack. Recovery is therefore possible and previously de-selected     seismograms may be selected again for the next iteration.</td>
</tr>
<tr>
<td><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;flip&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-property&quot;&gt;&lt;code&gt;property&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-writable&quot;&gt;&lt;code&gt;writable&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#pysmo.tools.iccs.ICCSSeismogram.flip"><code>flip</code></a></td>
<td>Determines if the     seismogram data should be flipped (i.e. multiplied with -1) before using     it in the stack and cross-correlation. Can be automatically toggled when     <code>autoflip</code>is <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/constants.html#True"><code>True</code></a> during a <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;__call__&lt;/span&gt;" href="#pysmo.tools.iccs.ICCS.__call__">run</a>.</td>
</tr>
</tbody>
</table>
<p>Two things worth mentioning:</p>
<ul>
<li>Because <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ICCSSeismogram&lt;/span&gt;" href="#pysmo.tools.iccs.ICCSSeismogram"><code>ICCSSeismogram</code></a> is a subclass of
  <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;Seismogram&lt;/span&gt;" href="../../../#pysmo.Seismogram"><code>Seismogram</code></a>, it can be used anywhere a basic
  <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;Seismogram&lt;/span&gt;" href="../../../#pysmo.Seismogram"><code>Seismogram</code></a> is expected.</li>
<li>All actions performed only effect the attributes listed above. The orignal
  <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;data&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#pysmo.tools.iccs.MiniICCSSeismogram.data"><code>data</code></a>,
  <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;begin_time&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#pysmo.tools.iccs.MiniICCSSeismogram.begin_time"><code>begin_time</code></a>, etc. are
  never modified.</li>
</ul>
<h3 id="pysmo.tools.iccs--execution-flow">Execution flow<a class="headerlink" href="#pysmo.tools.iccs--execution-flow" title="Permanent link">#</a></h3>
<p>The diagram below shows execution flow, and how the above parameters are used
when the ICCS algorithm is executed (see <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;__call__&lt;/span&gt;" href="#pysmo.tools.iccs.ICCS.__call__">here</a>
for parameters and default values)':</p>
<pre class="mermaid"><code>flowchart TD
Start(["ICCSSeismograms with initial parameters."])
Stack0["Generate windowed seismograms and create stack from them."]
C["Cross-correlate windowed seismograms with stack to obtain updated picks and normalised correlation coefficients."]
FlipQ{"Is **autoflip**
True?"}
Flip["Toggle **flip** attribute of seismograms with negative correlation coefficients."]
QualQ{"Is **autoselect**
True?"}
Qual1["Toggle **select** attribute of seismograms based on correlation coefficient."]
Stack1["Recompute windowed seismograms and stack with updated parameters."]
H{"Convergence
criteria met?"}
I{"Maximum
iterations
reached?"}
End(["ICCSSeismograms with updated **t1**, **flip**, and **select** parameters."])
Start --&gt; Stack0 --&gt; C --&gt; FlipQ --&gt;|No| QualQ --&gt;|No| Stack1 --&gt; H --&gt;|No| I --&gt;|No| C
FlipQ --&gt;|Yes| Flip --&gt; QualQ
QualQ --&gt;|Yes| Qual1 --&gt;  Stack1
H --&gt;|Yes| End
I --&gt;|Yes| End</code></pre>
<p>Convergence is reached when the stack iself is not changing significantly
anymore between iteration. Typically this happens within a few iterations.</p>
<h3 id="pysmo.tools.iccs--operator-involvement">Operator involvement<a class="headerlink" href="#pysmo.tools.iccs--operator-involvement" title="Permanent link">#</a></h3>
<p>The ICCS algorithm relies on a few parameters that need to be adjusted by the
user. This module provides functions to visualise the stack and individual
seismograms (all at the same time), and to update the parameters based on
visual inspection.</p>
<div class="footnote">
<hr />
<ol>
<li id="pysmo.tools.iccs--fn:1">
<p>Lou, X., et al. “AIMBAT: A Python/Matplotlib Tool for Measuring
Teleseismic Arrival Times.” Seismological Research Letters, vol. 84,
no. 1, Jan. 2013, pp. 85–93, https://doi.org/10.1785/0220120033.&#160;<a class="footnote-backref" href="#pysmo.tools.iccs--fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="pysmo.tools.iccs--fn:2">
<p>VanDecar, J. C., and R. S. Crosson. “Determination of Teleseismic
Relative Phase Arrival Times Using Multi-Channel Cross-Correlation and
Least Squares.” Bulletin of the Seismological Society of America,
vol. 80, no. 1, Feb. 1990, pp. 150–69,
https://doi.org/10.1785/BSSA0800010150.&#160;<a class="footnote-backref" href="#pysmo.tools.iccs--fnref:2" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
</ol>
</div>

          







<p><span class="doc-section-title">Classes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ICCS&lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs.ICCS&lt;/code&gt;)" href="#pysmo.tools.iccs.ICCS">ICCS</a></code></b>
          –
          <div class="doc-md-description">
            <p>Class to store a list of <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ICCSSeismogram&lt;/span&gt;" href="#pysmo.tools.iccs.ICCSSeismogram"><code>ICCSSeismograms</code></a> and run the ICCS algorithm.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ICCSSeismogram&lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs.ICCSSeismogram&lt;/code&gt;)" href="#pysmo.tools.iccs.ICCSSeismogram">ICCSSeismogram</a></code></b>
          –
          <div class="doc-md-description">
            <p>Protocol class to define the <code>ICCSSeismogram</code> type.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;MiniICCSSeismogram&lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs.MiniICCSSeismogram&lt;/code&gt;)" href="#pysmo.tools.iccs.MiniICCSSeismogram">MiniICCSSeismogram</a></code></b>
          –
          <div class="doc-md-description">
            <p>Minimal implementation of the <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ICCSSeismogram&lt;/span&gt;" href="#pysmo.tools.iccs.ICCSSeismogram"><code>ICCSSeismogram</code></a> type.</p>
          </div>
        </li>
    </ul>




<p><span class="doc-section-title">Functions:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-function&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;plot_seismograms&lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs.plot_seismograms&lt;/code&gt;)" href="#pysmo.tools.iccs.plot_seismograms">plot_seismograms</a></code></b>
            –
            <div class="doc-md-description">
              <p>Plot the selected ICCS seismograms as an image.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-function&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;plot_stack&lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs.plot_stack&lt;/code&gt;)" href="#pysmo.tools.iccs.plot_stack">plot_stack</a></code></b>
            –
            <div class="doc-md-description">
              <p>Plot the ICCS stack.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-function&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;update_all_picks&lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs.update_all_picks&lt;/code&gt;)" href="#pysmo.tools.iccs.update_all_picks">update_all_picks</a></code></b>
            –
            <div class="doc-md-description">
              <p>Update <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;t1&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-property&quot;&gt;&lt;code&gt;property&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-writable&quot;&gt;&lt;code&gt;writable&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#pysmo.tools.iccs.ICCSSeismogram.t1"><code>t1</code></a> in all seismograms by the same amount.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-function&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;update_min_ccnorm&lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs.update_min_ccnorm&lt;/code&gt;)" href="#pysmo.tools.iccs.update_min_ccnorm">update_min_ccnorm</a></code></b>
            –
            <div class="doc-md-description">
              <p>Interactively pick a new <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;min_ccnorm&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#pysmo.tools.iccs.ICCS.min_ccnorm"><code>min_ccnorm</code></a>.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-function&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;update_pick&lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs.update_pick&lt;/code&gt;)" href="#pysmo.tools.iccs.update_pick">update_pick</a></code></b>
            –
            <div class="doc-md-description">
              <p>Manually pick <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;t1&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-property&quot;&gt;&lt;code&gt;property&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-writable&quot;&gt;&lt;code&gt;writable&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#pysmo.tools.iccs.ICCSSeismogram.t1"><code>t1</code></a> and apply it to all seismograms.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-function&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;update_timewindow&lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs.update_timewindow&lt;/code&gt;)" href="#pysmo.tools.iccs.update_timewindow">update_timewindow</a></code></b>
            –
            <div class="doc-md-description">
              <p>Pick new time window limits.</p>
            </div>
          </li>
    </ul>





  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="pysmo.tools.iccs.ICCS" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">ICCS</span>


<a href="#pysmo.tools.iccs.ICCS" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">


        <p>Class to store a list of <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ICCSSeismogram&lt;/span&gt;" href="#pysmo.tools.iccs.ICCSSeismogram"><code>ICCSSeismograms</code></a> and run the ICCS algorithm.</p>
<p>The <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ICCS&lt;/span&gt;" href="#pysmo.tools.iccs.ICCS"><code>ICCS</code></a> class serves as a container to store a
list of seismograms (typically recordings of the same event at different
stations), and to then run the ICCS algorithm when an instance of this
class is called. Processing parameters that are common to all seismograms
are stored as attributes (e.g. time window limits).</p>


<p><span class="doc-section-title">Examples:</span></p>
    <p>We begin with a set of SAC files of the same event, recorded at different
stations. All files have a preliminary phase arrival estimate saved in the
<code>T0</code> SAC header, so we can use these files to create instances of the
<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;MiniICCSSeismogram&lt;/span&gt;" href="#pysmo.tools.iccs.MiniICCSSeismogram"><code>MiniICCSSeismogram</code></a> class for use
with the <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ICCS&lt;/span&gt;" href="#pysmo.tools.iccs.ICCS"><code>ICCS</code></a> class:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">pysmo.classes</span><span class="w"> </span><span class="kn">import</span> <span class="n">SAC</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">pysmo.functions</span><span class="w"> </span><span class="kn">import</span> <span class="n">clone_to_mini</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">pysmo.tools.iccs</span><span class="w"> </span><span class="kn">import</span> <span class="n">MiniICCSSeismogram</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sacfiles</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;iccs-example/&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*.bhz&quot;</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">seismograms</span> <span class="o">=</span> <span class="p">[]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">sacfile</span> <span class="ow">in</span> <span class="n">sacfiles</span><span class="p">:</span>
<span class="o">...</span>     <span class="n">sac</span> <span class="o">=</span> <span class="n">SAC</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">sacfile</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">update</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;t0&quot;</span><span class="p">:</span> <span class="n">sac</span><span class="o">.</span><span class="n">timestamps</span><span class="o">.</span><span class="n">t0</span><span class="p">}</span>
<span class="o">...</span>     <span class="n">iccs_seismogram</span> <span class="o">=</span> <span class="n">clone_to_mini</span><span class="p">(</span><span class="n">MiniICCSSeismogram</span><span class="p">,</span> <span class="n">sac</span><span class="o">.</span><span class="n">seismogram</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="n">update</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">seismograms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iccs_seismogram</span><span class="p">)</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span>
</code></pre></div>
<p>To better illustrate the different modes of running the ICCS algorithm, we
modify the data and picks in the seismograms to make them <strong>worse</strong> than
they actually are:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">timedelta</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">copy</span><span class="w"> </span><span class="kn">import</span> <span class="n">deepcopy</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># change the sign of the data in the first seismogram</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">seismograms</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># move the initial pick 2 seconds earlier in second seismogram</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">seismograms</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">t0</span> <span class="o">+=</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># move the initial pick 2 seconds later in third seismogram</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">seismograms</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">t0</span> <span class="o">+=</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># create a seismogram with completely random data</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">iccs_random</span><span class="p">:</span> <span class="n">MiniICCSSeismogram</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">seismograms</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># set this for consistent results during testing</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">iccs_random</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">iccs_random</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">seismograms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iccs_random</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
</code></pre></div>
<p>We can now create an instance of the <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ICCS&lt;/span&gt;" href="#pysmo.tools.iccs.ICCS"><code>ICCS</code></a> class
and plot the initial stack together with the input seismograms:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">pysmo.tools.iccs</span><span class="w"> </span><span class="kn">import</span> <span class="n">ICCS</span><span class="p">,</span> <span class="n">plot_stack</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">iccs</span> <span class="o">=</span> <span class="n">ICCS</span><span class="p">(</span><span class="n">seismograms</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plot_stack</span><span class="p">(</span><span class="n">iccs</span><span class="p">,</span> <span class="n">padded</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
</code></pre></div>
<!-- invisible-code-block: python
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">if</span> <span class="n">savedir</span><span class="p">:</span>
<span class="o">...</span>     <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;dark_background&quot;</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">plot_stack</span><span class="p">(</span><span class="n">iccs</span><span class="p">,</span> <span class="n">padded</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savedir</span> <span class="o">/</span> <span class="s2">&quot;iccs_stack_initial-dark.png&quot;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">...</span>
<span class="o">...</span>     <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">plot_stack</span><span class="p">(</span><span class="n">iccs</span><span class="p">,</span> <span class="n">padded</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savedir</span> <span class="o">/</span> <span class="s2">&quot;iccs_stack_initial.png&quot;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
</code></pre></div>
-->

<p><img alt="Initial stack" loading="lazy" src="../../../../examples/figures/iccs_stack_initial.png#only-light" />
<img alt="Initial stack" loading="lazy" src="../../../../examples/figures/iccs_stack_initial-dark.png#only-dark" /></p>
<p>The phase emergance is not visible in the stack, and the (absolute)
correlation coefficents of the the seismograms are not very high. This
shows the initial picks are not very good and/or that the data are of low
quality. To run the ICCS algorithm, we simply call (execute) the ICCS
instance:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">convergence_list</span> <span class="o">=</span> <span class="n">iccs</span><span class="p">()</span>  <span class="c1"># this runs the ICCS algorithm and returns</span>
<span class="o">&gt;&gt;&gt;</span>                            <span class="c1"># a list of the convergence value after each</span>
<span class="o">&gt;&gt;&gt;</span>                            <span class="c1"># iteration.</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plot_stack</span><span class="p">(</span><span class="n">iccs</span><span class="p">,</span> <span class="n">padded</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
</code></pre></div>
<!-- invisible-code-block: python
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">if</span> <span class="n">savedir</span><span class="p">:</span>
<span class="o">...</span>     <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;dark_background&quot;</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">plot_stack</span><span class="p">(</span><span class="n">iccs</span><span class="p">,</span> <span class="n">padded</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savedir</span> <span class="o">/</span> <span class="s2">&quot;iccs_stack_first_run-dark.png&quot;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">...</span>
<span class="o">...</span>     <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">plot_stack</span><span class="p">(</span><span class="n">iccs</span><span class="p">,</span> <span class="n">padded</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savedir</span> <span class="o">/</span> <span class="s2">&quot;iccs_stack_first_run.png&quot;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
</code></pre></div>
-->

<p><img alt="Stack after first run" loading="lazy" src="../../../../examples/figures/iccs_stack_first_run.png#only-light" />
<img alt="Stack after first run" loading="lazy" src="../../../../examples/figures/iccs_stack_first_run-dark.png#only-dark" /></p>
<p>Despite of the random noise seismogram, the phase arrival is now visible in
the stack. Seismograms with low correlation coefficients can automatically
be deselected from the calculations by running ICCS again with
<code>autoselect=True</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">_</span> <span class="o">=</span> <span class="n">iccs</span><span class="p">(</span><span class="n">autoselect</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plot_stack</span><span class="p">(</span><span class="n">iccs</span><span class="p">,</span> <span class="n">padded</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
</code></pre></div>
<!-- invisible-code-block: python
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">if</span> <span class="n">savedir</span><span class="p">:</span>
<span class="o">...</span>     <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;dark_background&quot;</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">plot_stack</span><span class="p">(</span><span class="n">iccs</span><span class="p">,</span> <span class="n">padded</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savedir</span> <span class="o">/</span> <span class="s2">&quot;iccs_stack_autoselect-dark.png&quot;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">...</span>
<span class="o">...</span>     <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">plot_stack</span><span class="p">(</span><span class="n">iccs</span><span class="p">,</span> <span class="n">padded</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savedir</span> <span class="o">/</span> <span class="s2">&quot;iccs_stack_autoselect.png&quot;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
</code></pre></div>
-->

<p><img alt="Stack after run with autoselect" loading="lazy" src="../../../../examples/figures/iccs_stack_autoselect.png#only-light" />
<img alt="Stack after run with autoselect" loading="lazy" src="../../../../examples/figures/iccs_stack_autoselect-dark.png#only-dark" /></p>
<p>Seismograms that fit better with their polarity reversed can be flipped
automatically by setting <code>autoflip=True</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">_</span> <span class="o">=</span> <span class="n">iccs</span><span class="p">(</span><span class="n">autoflip</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plot_stack</span><span class="p">(</span><span class="n">iccs</span><span class="p">,</span> <span class="n">padded</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
</code></pre></div>
<!-- invisible-code-block: python
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">if</span> <span class="n">savedir</span><span class="p">:</span>
<span class="o">...</span>     <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;dark_background&quot;</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">plot_stack</span><span class="p">(</span><span class="n">iccs</span><span class="p">,</span> <span class="n">padded</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savedir</span> <span class="o">/</span> <span class="s2">&quot;iccs_stack_autoflip-dark.png&quot;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">...</span>
<span class="o">...</span>     <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">plot_stack</span><span class="p">(</span><span class="n">iccs</span><span class="p">,</span> <span class="n">padded</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savedir</span> <span class="o">/</span> <span class="s2">&quot;iccs_stack_autoflip.png&quot;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
</code></pre></div>
-->

<p><img alt="Stack after run with autoflip" loading="lazy" src="../../../../examples/figures/iccs_stack_autoflip.png#only-light" />
<img alt="Stack after run with autoflip" loading="lazy" src="../../../../examples/figures/iccs_stack_autoflip-dark.png#only-dark" /></p>
<p>To further improve results, you can interactively update the picks,
time window, and minimum correlation coefficient using
<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-function&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;update_pick&lt;/span&gt;" href="#pysmo.tools.iccs.update_pick"><code>update_pick</code></a>,
<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-function&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;update_timewindow&lt;/span&gt;" href="#pysmo.tools.iccs.update_timewindow"><code>update_timewindow</code></a>, and
<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-function&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;update_min_ccnorm&lt;/span&gt;" href="#pysmo.tools.iccs.update_min_ccnorm"><code>update_min_ccnorm</code></a>,
respectively, and then run the ICCS algorithm again.</p>

          









<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;__call__&lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs.ICCS.__call__&lt;/code&gt;)" href="#pysmo.tools.iccs.ICCS.__call__">__call__</a></code></b>
            –
            <div class="doc-md-description">
              <p>Run the iccs algorithm.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;validate_pick&lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs.ICCS.validate_pick&lt;/code&gt;)" href="#pysmo.tools.iccs.ICCS.validate_pick">validate_pick</a></code></b>
            –
            <div class="doc-md-description">
              <p>Check if a new pick is valid.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;validate_time_window&lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs.ICCS.validate_time_window&lt;/code&gt;)" href="#pysmo.tools.iccs.ICCS.validate_time_window">validate_time_window</a></code></b>
            –
            <div class="doc-md-description">
              <p>Check if a new time window (relative to pick) is valid.</p>
            </div>
          </li>
    </ul>




<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;cc_seismograms&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-property&quot;&gt;&lt;code&gt;property&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs.ICCS.cc_seismograms&lt;/code&gt;)" href="#pysmo.tools.iccs.ICCS.cc_seismograms">cc_seismograms</a></code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;MiniSeismogram&lt;/span&gt; (&lt;code&gt;pysmo.MiniSeismogram&lt;/code&gt;)" href="../../../#pysmo.MiniSeismogram">MiniSeismogram</a>]</code>)
          –
          <div class="doc-md-description">
            <p>Returns the seismograms as used for the cross-correlation.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;ccnorms&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-property&quot;&gt;&lt;code&gt;property&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs.ICCS.ccnorms&lt;/code&gt;)" href="#pysmo.tools.iccs.ICCS.ccnorms">ccnorms</a></code></b>
              (<code><a class="autorefs autorefs-external" title="&lt;code&gt;numpy.ndarray&lt;/code&gt;" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>)
          –
          <div class="doc-md-description">
            <p>Returns an array of the normalised cross-correlation coefficients.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;min_ccnorm&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs.ICCS.min_ccnorm&lt;/code&gt;)" href="#pysmo.tools.iccs.ICCS.min_ccnorm">min_ccnorm</a></code></b>
              (<code><a class="autorefs autorefs-external" title="&lt;code&gt;numpy.floating&lt;/code&gt;" href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.floating">floating</a> | <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>)
          –
          <div class="doc-md-description">
            <p>Minimum normalised cross-correlation coefficient for seismograms.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;padded_seismograms&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-property&quot;&gt;&lt;code&gt;property&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs.ICCS.padded_seismograms&lt;/code&gt;)" href="#pysmo.tools.iccs.ICCS.padded_seismograms">padded_seismograms</a></code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;MiniSeismogram&lt;/span&gt; (&lt;code&gt;pysmo.MiniSeismogram&lt;/code&gt;)" href="../../../#pysmo.MiniSeismogram">MiniSeismogram</a>]</code>)
          –
          <div class="doc-md-description">
            <p>Returns the seismograms with extra padding for plotting.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;padded_stack&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-property&quot;&gt;&lt;code&gt;property&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs.ICCS.padded_stack&lt;/code&gt;)" href="#pysmo.tools.iccs.ICCS.padded_stack">padded_stack</a></code></b>
              (<code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;MiniSeismogram&lt;/span&gt; (&lt;code&gt;pysmo.MiniSeismogram&lt;/code&gt;)" href="../../../#pysmo.MiniSeismogram">MiniSeismogram</a></code>)
          –
          <div class="doc-md-description">
            <p>Returns the stacked <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;padded_seismograms&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-property&quot;&gt;&lt;code&gt;property&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#pysmo.tools.iccs.ICCS.padded_seismograms"><code>padded_seismograms</code></a>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;plot_padding&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs.ICCS.plot_padding&lt;/code&gt;)" href="#pysmo.tools.iccs.ICCS.plot_padding">plot_padding</a></code></b>
              (<code><a class="autorefs autorefs-external" title="&lt;code&gt;datetime.timedelta&lt;/code&gt;" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta">timedelta</a></code>)
          –
          <div class="doc-md-description">
            <p>Padding to apply before and after the time window.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;seismograms&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs.ICCS.seismograms&lt;/code&gt;)" href="#pysmo.tools.iccs.ICCS.seismograms">seismograms</a></code></b>
              (<code><a class="autorefs autorefs-external" title="&lt;code&gt;collections.abc.Sequence&lt;/code&gt;" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence">Sequence</a>[<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ICCSSeismogram&lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs._types.ICCSSeismogram&lt;/code&gt;)" href="#pysmo.tools.iccs.ICCSSeismogram">ICCSSeismogram</a>]</code>)
          –
          <div class="doc-md-description">
            <p>Input seismograms.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;stack&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-property&quot;&gt;&lt;code&gt;property&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs.ICCS.stack&lt;/code&gt;)" href="#pysmo.tools.iccs.ICCS.stack">stack</a></code></b>
              (<code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;MiniSeismogram&lt;/span&gt; (&lt;code&gt;pysmo.MiniSeismogram&lt;/code&gt;)" href="../../../#pysmo.MiniSeismogram">MiniSeismogram</a></code>)
          –
          <div class="doc-md-description">
            <p>Returns the stacked <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;cc_seismograms&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-property&quot;&gt;&lt;code&gt;property&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#pysmo.tools.iccs.ICCS.cc_seismograms"><code>cc_seismograms</code></a>).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;taper_width&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs.ICCS.taper_width&lt;/code&gt;)" href="#pysmo.tools.iccs.ICCS.taper_width">taper_width</a></code></b>
              (<code><a class="autorefs autorefs-external" title="&lt;code&gt;datetime.timedelta&lt;/code&gt;" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta">timedelta</a> | <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>)
          –
          <div class="doc-md-description">
            <p>Taper width.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;window_post&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs.ICCS.window_post&lt;/code&gt;)" href="#pysmo.tools.iccs.ICCS.window_post">window_post</a></code></b>
              (<code><a class="autorefs autorefs-external" title="&lt;code&gt;datetime.timedelta&lt;/code&gt;" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta">timedelta</a></code>)
          –
          <div class="doc-md-description">
            <p>End of the time window relative to the pick.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;window_pre&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs.ICCS.window_pre&lt;/code&gt;)" href="#pysmo.tools.iccs.ICCS.window_pre">window_pre</a></code></b>
              (<code><a class="autorefs autorefs-external" title="&lt;code&gt;datetime.timedelta&lt;/code&gt;" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta">timedelta</a></code>)
          –
          <div class="doc-md-description">
            <p>Begining of the time window relative to the pick.</p>
          </div>
        </li>
    </ul>

              <details class="quote">
                <summary>Source code in <code>pysmo/tools/iccs/_iccs.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@define</span><span class="p">(</span><span class="n">slots</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ICCS</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class to store a list of [`ICCSSeismograms`][pysmo.tools.iccs.ICCSSeismogram] and run the ICCS algorithm.</span>

<span class="sd">    The [`ICCS`][pysmo.tools.iccs.ICCS] class serves as a container to store a</span>
<span class="sd">    list of seismograms (typically recordings of the same event at different</span>
<span class="sd">    stations), and to then run the ICCS algorithm when an instance of this</span>
<span class="sd">    class is called. Processing parameters that are common to all seismograms</span>
<span class="sd">    are stored as attributes (e.g. time window limits).</span>

<span class="sd">    Examples:</span>
<span class="sd">        We begin with a set of SAC files of the same event, recorded at different</span>
<span class="sd">        stations. All files have a preliminary phase arrival estimate saved in the</span>
<span class="sd">        `T0` SAC header, so we can use these files to create instances of the</span>
<span class="sd">        [`MiniICCSSeismogram`][pysmo.tools.iccs.MiniICCSSeismogram] class for use</span>
<span class="sd">        with the [`ICCS`][pysmo.tools.iccs.ICCS] class:</span>

<span class="sd">        ```python</span>
<span class="sd">        &gt;&gt;&gt; from pysmo.classes import SAC</span>
<span class="sd">        &gt;&gt;&gt; from pysmo.functions import clone_to_mini</span>
<span class="sd">        &gt;&gt;&gt; from pysmo.tools.iccs import MiniICCSSeismogram</span>
<span class="sd">        &gt;&gt;&gt; from pathlib import Path</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; sacfiles = sorted(Path(&quot;iccs-example/&quot;).glob(&quot;*.bhz&quot;))</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; seismograms = []</span>
<span class="sd">        &gt;&gt;&gt; for sacfile in sacfiles:</span>
<span class="sd">        ...     sac = SAC.from_file(sacfile)</span>
<span class="sd">        ...     update = {&quot;t0&quot;: sac.timestamps.t0}</span>
<span class="sd">        ...     iccs_seismogram = clone_to_mini(MiniICCSSeismogram, sac.seismogram, update=update)</span>
<span class="sd">        ...     seismograms.append(iccs_seismogram)</span>
<span class="sd">        ...</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        ```</span>

<span class="sd">        To better illustrate the different modes of running the ICCS algorithm, we</span>
<span class="sd">        modify the data and picks in the seismograms to make them **worse** than</span>
<span class="sd">        they actually are:</span>

<span class="sd">        ```python</span>
<span class="sd">        &gt;&gt;&gt; from datetime import timedelta</span>
<span class="sd">        &gt;&gt;&gt; from copy import deepcopy</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # change the sign of the data in the first seismogram</span>
<span class="sd">        &gt;&gt;&gt; seismograms[0].data *= -1</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # move the initial pick 2 seconds earlier in second seismogram</span>
<span class="sd">        &gt;&gt;&gt; seismograms[1].t0 += timedelta(seconds=-2)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # move the initial pick 2 seconds later in third seismogram</span>
<span class="sd">        &gt;&gt;&gt; seismograms[2].t0 += timedelta(seconds=2)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # create a seismogram with completely random data</span>
<span class="sd">        &gt;&gt;&gt; iccs_random: MiniICCSSeismogram = deepcopy(seismograms[-1])</span>
<span class="sd">        &gt;&gt;&gt; np.random.seed(42)  # set this for consistent results during testing</span>
<span class="sd">        &gt;&gt;&gt; iccs_random.data = np.random.rand(len(iccs_random))</span>
<span class="sd">        &gt;&gt;&gt; seismograms.append(iccs_random)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        ```</span>

<span class="sd">        We can now create an instance of the [`ICCS`][pysmo.tools.iccs.ICCS] class</span>
<span class="sd">        and plot the initial stack together with the input seismograms:</span>

<span class="sd">        ```python</span>
<span class="sd">        &gt;&gt;&gt; from pysmo.tools.iccs import ICCS, plot_stack</span>
<span class="sd">        &gt;&gt;&gt; iccs = ICCS(seismograms)</span>
<span class="sd">        &gt;&gt;&gt; plot_stack(iccs, padded=False)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        ```</span>

<span class="sd">        &lt;!-- invisible-code-block: python</span>
<span class="sd">        ```</span>
<span class="sd">        &gt;&gt;&gt; import matplotlib.pyplot as plt</span>
<span class="sd">        &gt;&gt;&gt; plt.close(&quot;all&quot;)</span>
<span class="sd">        &gt;&gt;&gt; if savedir:</span>
<span class="sd">        ...     plt.style.use(&quot;dark_background&quot;)</span>
<span class="sd">        ...     fig, _ = plot_stack(iccs, padded=False, return_fig=True)</span>
<span class="sd">        ...     fig.savefig(savedir / &quot;iccs_stack_initial-dark.png&quot;, transparent=True)</span>
<span class="sd">        ...</span>
<span class="sd">        ...     plt.style.use(&quot;default&quot;)</span>
<span class="sd">        ...     fig, _ = plot_stack(iccs, padded=False, return_fig=True)</span>
<span class="sd">        ...     fig.savefig(savedir / &quot;iccs_stack_initial.png&quot;, transparent=True)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        ```</span>
<span class="sd">        --&gt;</span>

<span class="sd">        ![Initial stack](../../../examples/figures/iccs_stack_initial.png#only-light){ loading=lazy }</span>
<span class="sd">        ![Initial stack](../../../examples/figures/iccs_stack_initial-dark.png#only-dark){ loading=lazy }</span>

<span class="sd">        The phase emergance is not visible in the stack, and the (absolute)</span>
<span class="sd">        correlation coefficents of the the seismograms are not very high. This</span>
<span class="sd">        shows the initial picks are not very good and/or that the data are of low</span>
<span class="sd">        quality. To run the ICCS algorithm, we simply call (execute) the ICCS</span>
<span class="sd">        instance:</span>

<span class="sd">        ```python</span>
<span class="sd">        &gt;&gt;&gt; convergence_list = iccs()  # this runs the ICCS algorithm and returns</span>
<span class="sd">        &gt;&gt;&gt;                            # a list of the convergence value after each</span>
<span class="sd">        &gt;&gt;&gt;                            # iteration.</span>
<span class="sd">        &gt;&gt;&gt; plot_stack(iccs, padded=False)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        ```</span>

<span class="sd">        &lt;!-- invisible-code-block: python</span>
<span class="sd">        ```</span>
<span class="sd">        &gt;&gt;&gt; import matplotlib.pyplot as plt</span>
<span class="sd">        &gt;&gt;&gt; plt.close(&quot;all&quot;)</span>
<span class="sd">        &gt;&gt;&gt; if savedir:</span>
<span class="sd">        ...     plt.style.use(&quot;dark_background&quot;)</span>
<span class="sd">        ...     fig, _ = plot_stack(iccs, padded=False, return_fig=True)</span>
<span class="sd">        ...     fig.savefig(savedir / &quot;iccs_stack_first_run-dark.png&quot;, transparent=True)</span>
<span class="sd">        ...</span>
<span class="sd">        ...     plt.style.use(&quot;default&quot;)</span>
<span class="sd">        ...     fig, _ = plot_stack(iccs, padded=False, return_fig=True)</span>
<span class="sd">        ...     fig.savefig(savedir / &quot;iccs_stack_first_run.png&quot;, transparent=True)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        ```</span>
<span class="sd">        --&gt;</span>

<span class="sd">        ![Stack after first run](../../../examples/figures/iccs_stack_first_run.png#only-light){ loading=lazy }</span>
<span class="sd">        ![Stack after first run](../../../examples/figures/iccs_stack_first_run-dark.png#only-dark){ loading=lazy }</span>

<span class="sd">        Despite of the random noise seismogram, the phase arrival is now visible in</span>
<span class="sd">        the stack. Seismograms with low correlation coefficients can automatically</span>
<span class="sd">        be deselected from the calculations by running ICCS again with</span>
<span class="sd">        `autoselect=True`:</span>


<span class="sd">        ```python</span>
<span class="sd">        &gt;&gt;&gt; _ = iccs(autoselect=True)</span>
<span class="sd">        &gt;&gt;&gt; plot_stack(iccs, padded=False)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        ```</span>

<span class="sd">        &lt;!-- invisible-code-block: python</span>
<span class="sd">        ```</span>
<span class="sd">        &gt;&gt;&gt; import matplotlib.pyplot as plt</span>
<span class="sd">        &gt;&gt;&gt; plt.close(&quot;all&quot;)</span>
<span class="sd">        &gt;&gt;&gt; if savedir:</span>
<span class="sd">        ...     plt.style.use(&quot;dark_background&quot;)</span>
<span class="sd">        ...     fig, _ = plot_stack(iccs, padded=False, return_fig=True)</span>
<span class="sd">        ...     fig.savefig(savedir / &quot;iccs_stack_autoselect-dark.png&quot;, transparent=True)</span>
<span class="sd">        ...</span>
<span class="sd">        ...     plt.style.use(&quot;default&quot;)</span>
<span class="sd">        ...     fig, _ = plot_stack(iccs, padded=False, return_fig=True)</span>
<span class="sd">        ...     fig.savefig(savedir / &quot;iccs_stack_autoselect.png&quot;, transparent=True)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        ```</span>
<span class="sd">        --&gt;</span>

<span class="sd">        ![Stack after run with autoselect](../../../examples/figures/iccs_stack_autoselect.png#only-light){ loading=lazy }</span>
<span class="sd">        ![Stack after run with autoselect](../../../examples/figures/iccs_stack_autoselect-dark.png#only-dark){ loading=lazy }</span>


<span class="sd">        Seismograms that fit better with their polarity reversed can be flipped</span>
<span class="sd">        automatically by setting `autoflip=True`:</span>

<span class="sd">        ```python</span>
<span class="sd">        &gt;&gt;&gt; _ = iccs(autoflip=True)</span>
<span class="sd">        &gt;&gt;&gt; plot_stack(iccs, padded=False)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        ```</span>

<span class="sd">        &lt;!-- invisible-code-block: python</span>
<span class="sd">        ```</span>
<span class="sd">        &gt;&gt;&gt; import matplotlib.pyplot as plt</span>
<span class="sd">        &gt;&gt;&gt; plt.close(&quot;all&quot;)</span>
<span class="sd">        &gt;&gt;&gt; if savedir:</span>
<span class="sd">        ...     plt.style.use(&quot;dark_background&quot;)</span>
<span class="sd">        ...     fig, _ = plot_stack(iccs, padded=False, return_fig=True)</span>
<span class="sd">        ...     fig.savefig(savedir / &quot;iccs_stack_autoflip-dark.png&quot;, transparent=True)</span>
<span class="sd">        ...</span>
<span class="sd">        ...     plt.style.use(&quot;default&quot;)</span>
<span class="sd">        ...     fig, _ = plot_stack(iccs, padded=False, return_fig=True)</span>
<span class="sd">        ...     fig.savefig(savedir / &quot;iccs_stack_autoflip.png&quot;, transparent=True)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        ```</span>
<span class="sd">        --&gt;</span>

<span class="sd">        ![Stack after run with autoflip](../../../examples/figures/iccs_stack_autoflip.png#only-light){ loading=lazy }</span>
<span class="sd">        ![Stack after run with autoflip](../../../examples/figures/iccs_stack_autoflip-dark.png#only-dark){ loading=lazy }</span>


<span class="sd">        To further improve results, you can interactively update the picks,</span>
<span class="sd">        time window, and minimum correlation coefficient using</span>
<span class="sd">        [`update_pick`][pysmo.tools.iccs.update_pick],</span>
<span class="sd">        [`update_timewindow`][pysmo.tools.iccs.update_timewindow], and</span>
<span class="sd">        [`update_min_ccnorm`][pysmo.tools.iccs.update_min_ccnorm],</span>
<span class="sd">        respectively, and then run the ICCS algorithm again.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">seismograms</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">ICCSSeismogram</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ICCSSeismogram</span><span class="p">](),</span> <span class="n">validator</span><span class="o">=</span><span class="n">_clear_cache_on_update</span>
    <span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Input seismograms.</span>

<span class="sd">    These seismograms provide the input data for ICCS. They are used to store</span>
<span class="sd">    processing parameters and create shorter seismograms (based on pick and</span>
<span class="sd">    time window) that are then used for cross-correlation. The shorter</span>
<span class="sd">    seismograms are created on the fly and then cached within an [`ICCS`]</span>
<span class="sd">    [pysmo.tools.iccs.ICCS] instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">window_pre</span><span class="p">:</span> <span class="n">timedelta</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="n">ICCS_DEFAULTS</span><span class="o">.</span><span class="n">WINDOW_PRE</span><span class="p">,</span>
        <span class="n">validator</span><span class="o">=</span><span class="p">[</span>
            <span class="n">validators</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">0</span><span class="p">)),</span>
            <span class="n">_validate_window_pre</span><span class="p">,</span>
            <span class="n">_clear_cache_on_update</span><span class="p">,</span>
        <span class="p">],</span>
    <span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Begining of the time window relative to the pick.&quot;&quot;&quot;</span>

    <span class="n">window_post</span><span class="p">:</span> <span class="n">timedelta</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="n">ICCS_DEFAULTS</span><span class="o">.</span><span class="n">WINDOW_POST</span><span class="p">,</span>
        <span class="n">validator</span><span class="o">=</span><span class="p">[</span>
            <span class="n">validators</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">0</span><span class="p">)),</span>
            <span class="n">_validate_window_post</span><span class="p">,</span>
            <span class="n">_clear_cache_on_update</span><span class="p">,</span>
        <span class="p">],</span>
    <span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;End of the time window relative to the pick.&quot;&quot;&quot;</span>

    <span class="n">plot_padding</span><span class="p">:</span> <span class="n">timedelta</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="n">ICCS_DEFAULTS</span><span class="o">.</span><span class="n">PLOT_PADDING</span><span class="p">,</span>
        <span class="n">validator</span><span class="o">=</span><span class="p">[</span><span class="n">validators</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">0</span><span class="p">)),</span> <span class="n">_clear_cache_on_update</span><span class="p">],</span>
    <span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Padding to apply before and after the time window.</span>

<span class="sd">    This padding is *not* used for the cross-correlation.&quot;&quot;&quot;</span>

    <span class="n">taper_width</span><span class="p">:</span> <span class="n">timedelta</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="n">ICCS_DEFAULTS</span><span class="o">.</span><span class="n">TAPER_WIDTH</span><span class="p">,</span> <span class="n">validator</span><span class="o">=</span><span class="n">_clear_cache_on_update</span>
    <span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Taper width.</span>

<span class="sd">    Can be either a timedelta or a float - see [`pysmo.functions.taper()`][pysmo.functions.taper]</span>
<span class="sd">    for details.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">min_ccnorm</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">floating</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">ICCS_DEFAULTS</span><span class="o">.</span><span class="n">MIN_CCNORM</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Minimum normalised cross-correlation coefficient for seismograms.</span>

<span class="sd">    When the ICCS algorithm is [executed][pysmo.tools.iccs.ICCS.__call__],</span>
<span class="sd">    the cross-correlation coefficient for each seismogram is calculated after</span>
<span class="sd">    each iteration. If `autoselect` is set to `True`, the</span>
<span class="sd">    [`select`][pysmo.tools.iccs.ICCSSeismogram.select] attribute of seismograms</span>
<span class="sd">    with with correlation coefficients below this value is set to `False`, and</span>
<span class="sd">    they are no longer used for the [`stack`][pysmo.tools.iccs.ICCS.stack].</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># The following attributes are cached to prevent unnecessary processing.</span>
    <span class="c1"># Setting the caches to None will force a new calculation when they are</span>
    <span class="c1"># requested.</span>
    <span class="n">_cc_seismograms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">MiniSeismogram</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">_padded_seismograms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">MiniSeismogram</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">_ccnorms</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">_cc_stack</span><span class="p">:</span> <span class="n">MiniSeismogram</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">_padded_stack</span><span class="p">:</span> <span class="n">MiniSeismogram</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">_valid_pick_range</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">timedelta</span><span class="p">,</span> <span class="n">timedelta</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">_valid_time_window_range</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">timedelta</span><span class="p">,</span> <span class="n">timedelta</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__attrs_post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_clear_caches</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_clear_caches</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clear all cached attributes.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cc_seismograms</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_padded_seismograms</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ccnorms</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cc_stack</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_padded_stack</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_valid_pick_range</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_valid_time_window_range</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">cc_seismograms</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">MiniSeismogram</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the seismograms as used for the cross-correlation.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cc_seismograms</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cc_seismograms</span> <span class="o">=</span> <span class="n">_prepare_seismograms</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">seismograms</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">window_pre</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">window_post</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">taper_width</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cc_seismograms</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">padded_seismograms</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">MiniSeismogram</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the seismograms with extra padding for plotting.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_padded_seismograms</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_padded_seismograms</span> <span class="o">=</span> <span class="n">_prepare_seismograms</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">seismograms</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">window_pre</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">window_post</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">taper_width</span><span class="p">,</span>
                <span class="kc">True</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_padding</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_padded_seismograms</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">ccnorms</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns an array of the normalised cross-correlation coefficients.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ccnorms</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ccnorms</span> <span class="o">=</span> <span class="n">_calc_ccnorms</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cc_seismograms</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ccnorms</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">stack</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MiniSeismogram</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the stacked [`cc_seismograms`][pysmo.tools.iccs.ICCS.cc_seismograms]).</span>

<span class="sd">        The stack is calculated as the average of all seismograms with the</span>
<span class="sd">        attribute [`select`][pysmo.tools.iccs.ICCSSeismogram.select] set to</span>
<span class="sd">        [`True`][True]. The [`begin_time`][pysmo.MiniSeismogram.begin_time] of</span>
<span class="sd">        the returned stack is the average of the [`begin_time`]</span>
<span class="sd">        [pysmo.tools.iccs.ICCSSeismogram.begin_time] of the input seismograms.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Stacked input seismograms.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cc_stack</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cc_stack</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_cc_stack</span> <span class="o">=</span> <span class="n">_create_stack</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cc_seismograms</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">seismograms</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cc_stack</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">padded_stack</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MiniSeismogram</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the stacked [`padded_seismograms`][pysmo.tools.iccs.ICCS.padded_seismograms].</span>

<span class="sd">        Returns:</span>
<span class="sd">            Stacked input seismograms.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_padded_stack</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_padded_stack</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_padded_stack</span> <span class="o">=</span> <span class="n">_create_stack</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">padded_seismograms</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">seismograms</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_padded_stack</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">validate_pick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pick</span><span class="p">:</span> <span class="n">timedelta</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if a new pick is valid.</span>

<span class="sd">        This checks if a new manual pick is valid for all selected seismograms.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            pick: New pick to validate.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Whether the new pick is valid.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># first calculate valid pick range if not done yet</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_valid_pick_range</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_valid_pick_range</span> <span class="o">=</span> <span class="n">_calc_valid_pick_range</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_valid_pick_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">pick</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_valid_pick_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">validate_time_window</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">window_pre</span><span class="p">:</span> <span class="n">timedelta</span><span class="p">,</span> <span class="n">window_post</span><span class="p">:</span> <span class="n">timedelta</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if a new time window (relative to pick) is valid.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            window_pre: New window start time to validate.</span>
<span class="sd">            window_post: New window end time to validate.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Whether the new time window is valid.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">window_pre</span> <span class="o">&gt;=</span> <span class="n">window_post</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">window_pre</span> <span class="o">&gt;</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">delta</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">window_post</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">delta</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># Calculate valid time window range if not done yet</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_valid_time_window_range</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_valid_time_window_range</span> <span class="o">=</span> <span class="n">_calc_valid_time_window_range</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_valid_time_window_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">window_pre</span>
            <span class="ow">and</span> <span class="n">window_post</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_valid_time_window_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">autoflip</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">autoselect</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">convergence_limit</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">ICCS_DEFAULTS</span><span class="o">.</span><span class="n">CONVERGENCE_LIMIT</span><span class="p">,</span>
        <span class="n">convergence_method</span><span class="p">:</span> <span class="n">CONVERGENCE_METHOD</span> <span class="o">=</span> <span class="n">ICCS_DEFAULTS</span><span class="o">.</span><span class="n">CONVERGENCE_METHOD</span><span class="p">,</span>
        <span class="n">max_iter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">ICCS_DEFAULTS</span><span class="o">.</span><span class="n">MAX_ITER</span><span class="p">,</span>
        <span class="n">max_shift</span><span class="p">:</span> <span class="n">timedelta</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">parallel</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run the iccs algorithm.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            autoflip: Automatically toggle [`flip`][pysmo.tools.iccs.ICCSSeismogram.flip] attribute of seismograms.</span>
<span class="sd">            autoselect: Automatically set `select` attribute to `False` for poor quality seismograms.</span>
<span class="sd">            convergence_limit: Convergence limit at which the algorithm stops.</span>
<span class="sd">            convergence_method: Method to calculate convergence criterion.</span>
<span class="sd">            max_iter: Maximum number of iterations.</span>
<span class="sd">            max_shift: Maximum shift in seconds (see [`delay()`][pysmo.tools.signal.delay]).</span>
<span class="sd">            parallel: Whether to use parallel processing. Setting this to `True`</span>
<span class="sd">                will perform the cross-correlation calculations in parallel</span>
<span class="sd">                using [`ProcessPoolExecutor`][concurrent.futures.ProcessPoolExecutor].</span>
<span class="sd">                In most cases this will *not* be faster.</span>

<span class="sd">        Returns:</span>
<span class="sd">            convergence: Array of convergence criterion values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">convergence_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_iter</span><span class="p">):</span>
            <span class="n">prev_stack</span> <span class="o">=</span> <span class="n">clone_to_mini</span><span class="p">(</span><span class="n">MiniSeismogram</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">parallel</span><span class="p">:</span>
                <span class="k">with</span> <span class="n">ProcessPoolExecutor</span><span class="p">()</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">prepared_seismogram</span><span class="p">,</span> <span class="n">seismogram</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">cc_seismograms</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">seismograms</span>
                    <span class="p">):</span>
                        <span class="n">future</span> <span class="o">=</span> <span class="n">executor</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span>
                            <span class="n">delay</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">,</span>
                            <span class="n">prepared_seismogram</span><span class="p">,</span>
                            <span class="n">max_shift</span><span class="o">=</span><span class="n">max_shift</span><span class="p">,</span>
                            <span class="n">abs_max</span><span class="o">=</span><span class="n">autoflip</span><span class="p">,</span>
                        <span class="p">)</span>
                        <span class="n">future</span><span class="o">.</span><span class="n">add_done_callback</span><span class="p">(</span>
                            <span class="n">partial</span><span class="p">(</span>
                                <span class="n">_update_seismogram_fn</span><span class="p">,</span>
                                <span class="n">seismogram</span><span class="p">,</span>
                                <span class="n">autoflip</span><span class="p">,</span>
                                <span class="n">autoselect</span><span class="p">,</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">min_ccnorm</span><span class="p">,</span>
                                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">window_pre</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_post</span><span class="p">),</span>
                            <span class="p">)</span>
                        <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">prepared_seismogram</span><span class="p">,</span> <span class="n">seismogram</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">cc_seismograms</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">seismograms</span>
                <span class="p">):</span>
                    <span class="n">_delay</span><span class="p">,</span> <span class="n">_ccnorm</span> <span class="o">=</span> <span class="n">delay</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">,</span>
                        <span class="n">prepared_seismogram</span><span class="p">,</span>
                        <span class="n">max_shift</span><span class="o">=</span><span class="n">max_shift</span><span class="p">,</span>
                        <span class="n">abs_max</span><span class="o">=</span><span class="n">autoflip</span><span class="p">,</span>
                    <span class="p">)</span>

                    <span class="n">_update_seismogram</span><span class="p">(</span>
                        <span class="n">_delay</span><span class="p">,</span>
                        <span class="n">_ccnorm</span><span class="p">,</span>
                        <span class="n">seismogram</span><span class="p">,</span>
                        <span class="n">autoflip</span><span class="p">,</span>
                        <span class="n">autoselect</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">min_ccnorm</span><span class="p">,</span>
                        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">window_pre</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_post</span><span class="p">),</span>
                    <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_clear_caches</span><span class="p">()</span>

            <span class="n">convergence</span> <span class="o">=</span> <span class="n">_calc_convergence</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">,</span> <span class="n">prev_stack</span><span class="p">,</span> <span class="n">convergence_method</span><span class="p">)</span>
            <span class="n">convergence_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">convergence</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">convergence</span> <span class="o">&lt;=</span> <span class="n">convergence_limit</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">convergence_list</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="pysmo.tools.iccs.ICCS.cc_seismograms" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">cc_seismograms</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#pysmo.tools.iccs.ICCS.cc_seismograms" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">cc_seismograms</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;MiniSeismogram&lt;/span&gt; (&lt;code&gt;pysmo.MiniSeismogram&lt;/code&gt;)" href="../../../#pysmo.MiniSeismogram">MiniSeismogram</a></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns the seismograms as used for the cross-correlation.</p>

          
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="pysmo.tools.iccs.ICCS.ccnorms" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">ccnorms</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#pysmo.tools.iccs.ICCS.ccnorms" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">ccnorms</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;numpy.ndarray&lt;/code&gt;" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns an array of the normalised cross-correlation coefficients.</p>

          
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="pysmo.tools.iccs.ICCS.min_ccnorm" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">min_ccnorm</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#pysmo.tools.iccs.ICCS.min_ccnorm" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">min_ccnorm</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;numpy.floating&lt;/code&gt;" href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.floating">floating</a></span> <span class="o">|</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">=</span> <span class="n"><span title="pysmo.tools.iccs._defaults.ICCS_DEFAULTS.MIN_CCNORM">MIN_CCNORM</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Minimum normalised cross-correlation coefficient for seismograms.</p>
<p>When the ICCS algorithm is <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;__call__&lt;/span&gt;" href="#pysmo.tools.iccs.ICCS.__call__">executed</a>,
the cross-correlation coefficient for each seismogram is calculated after
each iteration. If <code>autoselect</code> is set to <code>True</code>, the
<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;select&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-property&quot;&gt;&lt;code&gt;property&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-writable&quot;&gt;&lt;code&gt;writable&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#pysmo.tools.iccs.ICCSSeismogram.select"><code>select</code></a> attribute of seismograms
with with correlation coefficients below this value is set to <code>False</code>, and
they are no longer used for the <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;stack&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-property&quot;&gt;&lt;code&gt;property&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#pysmo.tools.iccs.ICCS.stack"><code>stack</code></a>.</p>

          
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="pysmo.tools.iccs.ICCS.padded_seismograms" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">padded_seismograms</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#pysmo.tools.iccs.ICCS.padded_seismograms" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">padded_seismograms</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;MiniSeismogram&lt;/span&gt; (&lt;code&gt;pysmo.MiniSeismogram&lt;/code&gt;)" href="../../../#pysmo.MiniSeismogram">MiniSeismogram</a></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns the seismograms with extra padding for plotting.</p>

          
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="pysmo.tools.iccs.ICCS.padded_stack" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">padded_stack</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#pysmo.tools.iccs.ICCS.padded_stack" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">padded_stack</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;MiniSeismogram&lt;/span&gt; (&lt;code&gt;pysmo.MiniSeismogram&lt;/code&gt;)" href="../../../#pysmo.MiniSeismogram">MiniSeismogram</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns the stacked <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;padded_seismograms&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-property&quot;&gt;&lt;code&gt;property&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#pysmo.tools.iccs.ICCS.padded_seismograms"><code>padded_seismograms</code></a>.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;MiniSeismogram&lt;/span&gt; (&lt;code&gt;pysmo.MiniSeismogram&lt;/code&gt;)" href="../../../#pysmo.MiniSeismogram">MiniSeismogram</a></code>
          –
          <div class="doc-md-description">
            <p>Stacked input seismograms.</p>
          </div>
        </li>
    </ul>

          
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="pysmo.tools.iccs.ICCS.plot_padding" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">plot_padding</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#pysmo.tools.iccs.ICCS.plot_padding" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">plot_padding</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;datetime.timedelta&lt;/code&gt;" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta">timedelta</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;attrs.field&lt;/code&gt;" href="https://attrs.org/en/stable/api.html#attrs.field">field</a></span><span class="p">(</span>
    <span class="n"><span title="attrs.field(default)">default</span></span><span class="o">=</span><span class="n"><span title="pysmo.tools.iccs._defaults.ICCS_DEFAULTS.PLOT_PADDING">PLOT_PADDING</span></span><span class="p">,</span>
    <span class="n"><span title="attrs.field(validator)">validator</span></span><span class="o">=</span><span class="p">[</span>
        <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;attrs.validators.gt&lt;/code&gt;" href="https://attrs.org/en/stable/api.html#attrs.validators.gt">gt</a></span><span class="p">(</span><span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;datetime.timedelta&lt;/code&gt;" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta">timedelta</a></span><span class="p">(</span><span class="n"><span title="datetime.timedelta(seconds)">seconds</span></span><span class="o">=</span><span class="mi">0</span><span class="p">)),</span>
        <span class="n"><span title="pysmo.tools.iccs._iccs._clear_cache_on_update">_clear_cache_on_update</span></span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Padding to apply before and after the time window.</p>
<p>This padding is <em>not</em> used for the cross-correlation.</p>

          
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="pysmo.tools.iccs.ICCS.seismograms" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">seismograms</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#pysmo.tools.iccs.ICCS.seismograms" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">seismograms</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;collections.abc.Sequence&lt;/code&gt;" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence">Sequence</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ICCSSeismogram&lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs._types.ICCSSeismogram&lt;/code&gt;)" href="#pysmo.tools.iccs.ICCSSeismogram">ICCSSeismogram</a></span><span class="p">]</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;attrs.field&lt;/code&gt;" href="https://attrs.org/en/stable/api.html#attrs.field">field</a></span><span class="p">(</span>
    <span class="n"><span title="attrs.field(factory)">factory</span></span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ICCSSeismogram&lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs._types.ICCSSeismogram&lt;/code&gt;)" href="#pysmo.tools.iccs.ICCSSeismogram">ICCSSeismogram</a></span><span class="p">](),</span>
    <span class="n"><span title="attrs.field(validator)">validator</span></span><span class="o">=</span><span class="n"><span title="pysmo.tools.iccs._iccs._clear_cache_on_update">_clear_cache_on_update</span></span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Input seismograms.</p>
<p>These seismograms provide the input data for ICCS. They are used to store
processing parameters and create shorter seismograms (based on pick and
time window) that are then used for cross-correlation. The shorter
seismograms are created on the fly and then cached within an <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ICCS&lt;/span&gt;" href="#pysmo.tools.iccs.ICCS"><code>ICCS</code></a> instance.</p>

          
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="pysmo.tools.iccs.ICCS.stack" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">stack</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#pysmo.tools.iccs.ICCS.stack" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">stack</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;MiniSeismogram&lt;/span&gt; (&lt;code&gt;pysmo.MiniSeismogram&lt;/code&gt;)" href="../../../#pysmo.MiniSeismogram">MiniSeismogram</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns the stacked <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;cc_seismograms&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-property&quot;&gt;&lt;code&gt;property&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#pysmo.tools.iccs.ICCS.cc_seismograms"><code>cc_seismograms</code></a>).</p>
<p>The stack is calculated as the average of all seismograms with the
attribute <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;select&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-property&quot;&gt;&lt;code&gt;property&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-writable&quot;&gt;&lt;code&gt;writable&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#pysmo.tools.iccs.ICCSSeismogram.select"><code>select</code></a> set to
<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/constants.html#True"><code>True</code></a>. The <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;begin_time&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="../../../#pysmo.MiniSeismogram.begin_time"><code>begin_time</code></a> of
the returned stack is the average of the <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;begin_time&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-property&quot;&gt;&lt;code&gt;property&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-writable&quot;&gt;&lt;code&gt;writable&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#pysmo.tools.iccs.ICCSSeismogram.begin_time"><code>begin_time</code></a> of the input seismograms.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;MiniSeismogram&lt;/span&gt; (&lt;code&gt;pysmo.MiniSeismogram&lt;/code&gt;)" href="../../../#pysmo.MiniSeismogram">MiniSeismogram</a></code>
          –
          <div class="doc-md-description">
            <p>Stacked input seismograms.</p>
          </div>
        </li>
    </ul>

          
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="pysmo.tools.iccs.ICCS.taper_width" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">taper_width</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#pysmo.tools.iccs.ICCS.taper_width" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">taper_width</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;datetime.timedelta&lt;/code&gt;" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta">timedelta</a></span> <span class="o">|</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;attrs.field&lt;/code&gt;" href="https://attrs.org/en/stable/api.html#attrs.field">field</a></span><span class="p">(</span>
    <span class="n"><span title="attrs.field(default)">default</span></span><span class="o">=</span><span class="n"><span title="pysmo.tools.iccs._defaults.ICCS_DEFAULTS.TAPER_WIDTH">TAPER_WIDTH</span></span><span class="p">,</span> <span class="n"><span title="attrs.field(validator)">validator</span></span><span class="o">=</span><span class="n"><span title="pysmo.tools.iccs._iccs._clear_cache_on_update">_clear_cache_on_update</span></span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Taper width.</p>
<p>Can be either a timedelta or a float - see <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-function&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;taper&lt;/span&gt;" href="../../functions/#pysmo.functions.taper"><code>pysmo.functions.taper()</code></a>
for details.</p>

          
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="pysmo.tools.iccs.ICCS.window_post" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">window_post</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#pysmo.tools.iccs.ICCS.window_post" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">window_post</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;datetime.timedelta&lt;/code&gt;" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta">timedelta</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;attrs.field&lt;/code&gt;" href="https://attrs.org/en/stable/api.html#attrs.field">field</a></span><span class="p">(</span>
    <span class="n"><span title="attrs.field(default)">default</span></span><span class="o">=</span><span class="n"><span title="pysmo.tools.iccs._defaults.ICCS_DEFAULTS.WINDOW_POST">WINDOW_POST</span></span><span class="p">,</span>
    <span class="n"><span title="attrs.field(validator)">validator</span></span><span class="o">=</span><span class="p">[</span>
        <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;attrs.validators.gt&lt;/code&gt;" href="https://attrs.org/en/stable/api.html#attrs.validators.gt">gt</a></span><span class="p">(</span><span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;datetime.timedelta&lt;/code&gt;" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta">timedelta</a></span><span class="p">(</span><span class="n"><span title="datetime.timedelta(seconds)">seconds</span></span><span class="o">=</span><span class="mi">0</span><span class="p">)),</span>
        <span class="n"><span title="pysmo.tools.iccs._iccs._validate_window_post">_validate_window_post</span></span><span class="p">,</span>
        <span class="n"><span title="pysmo.tools.iccs._iccs._clear_cache_on_update">_clear_cache_on_update</span></span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>End of the time window relative to the pick.</p>

          
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="pysmo.tools.iccs.ICCS.window_pre" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">window_pre</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#pysmo.tools.iccs.ICCS.window_pre" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">window_pre</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;datetime.timedelta&lt;/code&gt;" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta">timedelta</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;attrs.field&lt;/code&gt;" href="https://attrs.org/en/stable/api.html#attrs.field">field</a></span><span class="p">(</span>
    <span class="n"><span title="attrs.field(default)">default</span></span><span class="o">=</span><span class="n"><span title="pysmo.tools.iccs._defaults.ICCS_DEFAULTS.WINDOW_PRE">WINDOW_PRE</span></span><span class="p">,</span>
    <span class="n"><span title="attrs.field(validator)">validator</span></span><span class="o">=</span><span class="p">[</span>
        <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;attrs.validators.lt&lt;/code&gt;" href="https://attrs.org/en/stable/api.html#attrs.validators.lt">lt</a></span><span class="p">(</span><span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;datetime.timedelta&lt;/code&gt;" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta">timedelta</a></span><span class="p">(</span><span class="n"><span title="datetime.timedelta(seconds)">seconds</span></span><span class="o">=</span><span class="mi">0</span><span class="p">)),</span>
        <span class="n"><span title="pysmo.tools.iccs._iccs._validate_window_pre">_validate_window_pre</span></span><span class="p">,</span>
        <span class="n"><span title="pysmo.tools.iccs._iccs._clear_cache_on_update">_clear_cache_on_update</span></span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Begining of the time window relative to the pick.</p>

          
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="pysmo.tools.iccs.ICCS.__call__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">__call__</span>


<a href="#pysmo.tools.iccs.ICCS.__call__" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">__call__</span><span class="p">(</span>
    <span class="n">autoflip</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">autoselect</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">convergence_limit</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">=</span> <span class="n"><span title="pysmo.tools.iccs._defaults.ICCS_DEFAULTS.CONVERGENCE_LIMIT">CONVERGENCE_LIMIT</span></span><span class="p">,</span>
    <span class="n">convergence_method</span><span class="p">:</span> <span class="n"><span title="pysmo.tools.iccs._iccs.CONVERGENCE_METHOD">CONVERGENCE_METHOD</span></span> <span class="o">=</span> <span class="n"><span title="pysmo.tools.iccs._defaults.ICCS_DEFAULTS.CONVERGENCE_METHOD">CONVERGENCE_METHOD</span></span><span class="p">,</span>
    <span class="n">max_iter</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="n"><span title="pysmo.tools.iccs._defaults.ICCS_DEFAULTS.MAX_ITER">MAX_ITER</span></span><span class="p">,</span>
    <span class="n">max_shift</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;datetime.timedelta&lt;/code&gt;" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta">timedelta</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">parallel</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;numpy.ndarray&lt;/code&gt;" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Run the iccs algorithm.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>autoflip</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>Automatically toggle <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;flip&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-property&quot;&gt;&lt;code&gt;property&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-writable&quot;&gt;&lt;code&gt;writable&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#pysmo.tools.iccs.ICCSSeismogram.flip"><code>flip</code></a> attribute of seismograms.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>autoselect</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>Automatically set <code>select</code> attribute to <code>False</code> for poor quality seismograms.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>convergence_limit</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                  <code><span title="pysmo.tools.iccs._defaults.ICCS_DEFAULTS.CONVERGENCE_LIMIT">CONVERGENCE_LIMIT</span></code>
)
          –
          <div class="doc-md-description">
            <p>Convergence limit at which the algorithm stops.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>convergence_method</code></b>
              (<code><span title="pysmo.tools.iccs._iccs.CONVERGENCE_METHOD">CONVERGENCE_METHOD</span></code>, default:
                  <code><span title="pysmo.tools.iccs._defaults.ICCS_DEFAULTS.CONVERGENCE_METHOD">CONVERGENCE_METHOD</span></code>
)
          –
          <div class="doc-md-description">
            <p>Method to calculate convergence criterion.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>max_iter</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code><span title="pysmo.tools.iccs._defaults.ICCS_DEFAULTS.MAX_ITER">MAX_ITER</span></code>
)
          –
          <div class="doc-md-description">
            <p>Maximum number of iterations.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>max_shift</code></b>
              (<code><a class="autorefs autorefs-external" title="&lt;code&gt;datetime.timedelta&lt;/code&gt;" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta">timedelta</a> | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Maximum shift in seconds (see <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-function&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;delay&lt;/span&gt;" href="../signal/#pysmo.tools.signal.delay"><code>delay()</code></a>).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>parallel</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to use parallel processing. Setting this to <code>True</code>
will perform the cross-correlation calculations in parallel
using <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/concurrent.futures.html#concurrent.futures.ProcessPoolExecutor"><code>ProcessPoolExecutor</code></a>.
In most cases this will <em>not</em> be faster.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>convergence</code></b> (              <code><a class="autorefs autorefs-external" title="&lt;code&gt;numpy.ndarray&lt;/code&gt;" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>
)          –
          <div class="doc-md-description">
            <p>Array of convergence criterion values.</p>
          </div>
        </li>
    </ul>

          

            <details class="quote">
              <summary>Source code in <code>pysmo/tools/iccs/_iccs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">autoflip</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">autoselect</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">convergence_limit</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">ICCS_DEFAULTS</span><span class="o">.</span><span class="n">CONVERGENCE_LIMIT</span><span class="p">,</span>
    <span class="n">convergence_method</span><span class="p">:</span> <span class="n">CONVERGENCE_METHOD</span> <span class="o">=</span> <span class="n">ICCS_DEFAULTS</span><span class="o">.</span><span class="n">CONVERGENCE_METHOD</span><span class="p">,</span>
    <span class="n">max_iter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">ICCS_DEFAULTS</span><span class="o">.</span><span class="n">MAX_ITER</span><span class="p">,</span>
    <span class="n">max_shift</span><span class="p">:</span> <span class="n">timedelta</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">parallel</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Run the iccs algorithm.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        autoflip: Automatically toggle [`flip`][pysmo.tools.iccs.ICCSSeismogram.flip] attribute of seismograms.</span>
<span class="sd">        autoselect: Automatically set `select` attribute to `False` for poor quality seismograms.</span>
<span class="sd">        convergence_limit: Convergence limit at which the algorithm stops.</span>
<span class="sd">        convergence_method: Method to calculate convergence criterion.</span>
<span class="sd">        max_iter: Maximum number of iterations.</span>
<span class="sd">        max_shift: Maximum shift in seconds (see [`delay()`][pysmo.tools.signal.delay]).</span>
<span class="sd">        parallel: Whether to use parallel processing. Setting this to `True`</span>
<span class="sd">            will perform the cross-correlation calculations in parallel</span>
<span class="sd">            using [`ProcessPoolExecutor`][concurrent.futures.ProcessPoolExecutor].</span>
<span class="sd">            In most cases this will *not* be faster.</span>

<span class="sd">    Returns:</span>
<span class="sd">        convergence: Array of convergence criterion values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">convergence_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_iter</span><span class="p">):</span>
        <span class="n">prev_stack</span> <span class="o">=</span> <span class="n">clone_to_mini</span><span class="p">(</span><span class="n">MiniSeismogram</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">parallel</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">ProcessPoolExecutor</span><span class="p">()</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">prepared_seismogram</span><span class="p">,</span> <span class="n">seismogram</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">cc_seismograms</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">seismograms</span>
                <span class="p">):</span>
                    <span class="n">future</span> <span class="o">=</span> <span class="n">executor</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span>
                        <span class="n">delay</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">,</span>
                        <span class="n">prepared_seismogram</span><span class="p">,</span>
                        <span class="n">max_shift</span><span class="o">=</span><span class="n">max_shift</span><span class="p">,</span>
                        <span class="n">abs_max</span><span class="o">=</span><span class="n">autoflip</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="n">future</span><span class="o">.</span><span class="n">add_done_callback</span><span class="p">(</span>
                        <span class="n">partial</span><span class="p">(</span>
                            <span class="n">_update_seismogram_fn</span><span class="p">,</span>
                            <span class="n">seismogram</span><span class="p">,</span>
                            <span class="n">autoflip</span><span class="p">,</span>
                            <span class="n">autoselect</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">min_ccnorm</span><span class="p">,</span>
                            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">window_pre</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_post</span><span class="p">),</span>
                        <span class="p">)</span>
                    <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">prepared_seismogram</span><span class="p">,</span> <span class="n">seismogram</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cc_seismograms</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">seismograms</span>
            <span class="p">):</span>
                <span class="n">_delay</span><span class="p">,</span> <span class="n">_ccnorm</span> <span class="o">=</span> <span class="n">delay</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">,</span>
                    <span class="n">prepared_seismogram</span><span class="p">,</span>
                    <span class="n">max_shift</span><span class="o">=</span><span class="n">max_shift</span><span class="p">,</span>
                    <span class="n">abs_max</span><span class="o">=</span><span class="n">autoflip</span><span class="p">,</span>
                <span class="p">)</span>

                <span class="n">_update_seismogram</span><span class="p">(</span>
                    <span class="n">_delay</span><span class="p">,</span>
                    <span class="n">_ccnorm</span><span class="p">,</span>
                    <span class="n">seismogram</span><span class="p">,</span>
                    <span class="n">autoflip</span><span class="p">,</span>
                    <span class="n">autoselect</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">min_ccnorm</span><span class="p">,</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">window_pre</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_post</span><span class="p">),</span>
                <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_clear_caches</span><span class="p">()</span>

        <span class="n">convergence</span> <span class="o">=</span> <span class="n">_calc_convergence</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">,</span> <span class="n">prev_stack</span><span class="p">,</span> <span class="n">convergence_method</span><span class="p">)</span>
        <span class="n">convergence_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">convergence</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">convergence</span> <span class="o">&lt;=</span> <span class="n">convergence_limit</span><span class="p">:</span>
            <span class="k">break</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">convergence_list</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pysmo.tools.iccs.ICCS.validate_pick" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">validate_pick</span>


<a href="#pysmo.tools.iccs.ICCS.validate_pick" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">validate_pick</span><span class="p">(</span><span class="n">pick</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;datetime.timedelta&lt;/code&gt;" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta">timedelta</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Check if a new pick is valid.</p>
<p>This checks if a new manual pick is valid for all selected seismograms.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>pick</code></b>
              (<code><a class="autorefs autorefs-external" title="&lt;code&gt;datetime.timedelta&lt;/code&gt;" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta">timedelta</a></code>)
          –
          <div class="doc-md-description">
            <p>New pick to validate.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
          –
          <div class="doc-md-description">
            <p>Whether the new pick is valid.</p>
          </div>
        </li>
    </ul>

          

            <details class="quote">
              <summary>Source code in <code>pysmo/tools/iccs/_iccs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">validate_pick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pick</span><span class="p">:</span> <span class="n">timedelta</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if a new pick is valid.</span>

<span class="sd">    This checks if a new manual pick is valid for all selected seismograms.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        pick: New pick to validate.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Whether the new pick is valid.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># first calculate valid pick range if not done yet</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_valid_pick_range</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_valid_pick_range</span> <span class="o">=</span> <span class="n">_calc_valid_pick_range</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_valid_pick_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">pick</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_valid_pick_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pysmo.tools.iccs.ICCS.validate_time_window" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">validate_time_window</span>


<a href="#pysmo.tools.iccs.ICCS.validate_time_window" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">validate_time_window</span><span class="p">(</span>
    <span class="n">window_pre</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;datetime.timedelta&lt;/code&gt;" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta">timedelta</a></span><span class="p">,</span> <span class="n">window_post</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;datetime.timedelta&lt;/code&gt;" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta">timedelta</a></span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Check if a new time window (relative to pick) is valid.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>window_pre</code></b>
              (<code><a class="autorefs autorefs-external" title="&lt;code&gt;datetime.timedelta&lt;/code&gt;" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta">timedelta</a></code>)
          –
          <div class="doc-md-description">
            <p>New window start time to validate.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>window_post</code></b>
              (<code><a class="autorefs autorefs-external" title="&lt;code&gt;datetime.timedelta&lt;/code&gt;" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta">timedelta</a></code>)
          –
          <div class="doc-md-description">
            <p>New window end time to validate.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
          –
          <div class="doc-md-description">
            <p>Whether the new time window is valid.</p>
          </div>
        </li>
    </ul>

          

            <details class="quote">
              <summary>Source code in <code>pysmo/tools/iccs/_iccs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">validate_time_window</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">window_pre</span><span class="p">:</span> <span class="n">timedelta</span><span class="p">,</span> <span class="n">window_post</span><span class="p">:</span> <span class="n">timedelta</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if a new time window (relative to pick) is valid.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        window_pre: New window start time to validate.</span>
<span class="sd">        window_post: New window end time to validate.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Whether the new time window is valid.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">window_pre</span> <span class="o">&gt;=</span> <span class="n">window_post</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="n">window_pre</span> <span class="o">&gt;</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">delta</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="n">window_post</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">delta</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="c1"># Calculate valid time window range if not done yet</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_valid_time_window_range</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_valid_time_window_range</span> <span class="o">=</span> <span class="n">_calc_valid_time_window_range</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_valid_time_window_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">window_pre</span>
        <span class="ow">and</span> <span class="n">window_post</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_valid_time_window_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pysmo.tools.iccs.ICCSSeismogram" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">ICCSSeismogram</span>


<a href="#pysmo.tools.iccs.ICCSSeismogram" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;Seismogram&lt;/span&gt; (&lt;code&gt;pysmo.Seismogram&lt;/code&gt;)" href="../../../#pysmo.Seismogram">Seismogram</a></code>, <code><a class="autorefs autorefs-external" title="&lt;code&gt;typing.Protocol&lt;/code&gt;" href="https://docs.python.org/3/library/typing.html#typing.Protocol">Protocol</a></code></p>


        <p>Protocol class to define the <code>ICCSSeismogram</code> type.</p>
<p>The <code>ICCSSeismogram</code> type extends the <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;Seismogram&lt;/span&gt;" href="../../../#pysmo.Seismogram"><code>Seismogram</code></a> type
with the addition of parameters that are required for ICCS.</p>

          









<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;__len__&lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs.ICCSSeismogram.__len__&lt;/code&gt;)" href="#pysmo.tools.iccs.ICCSSeismogram.__len__">__len__</a></code></b>
            –
            <div class="doc-md-description">
              <p>The length of the Seismogram.</p>
            </div>
          </li>
    </ul>




<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;begin_time&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-property&quot;&gt;&lt;code&gt;property&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-writable&quot;&gt;&lt;code&gt;writable&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs.ICCSSeismogram.begin_time&lt;/code&gt;)" href="#pysmo.tools.iccs.ICCSSeismogram.begin_time">begin_time</a></code></b>
              (<code><a class="autorefs autorefs-external" title="&lt;code&gt;datetime.datetime&lt;/code&gt;" href="https://docs.python.org/3/library/datetime.html#datetime.datetime">datetime</a></code>)
          –
          <div class="doc-md-description">
            <p>Seismogram begin time.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;data&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-property&quot;&gt;&lt;code&gt;property&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-writable&quot;&gt;&lt;code&gt;writable&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs.ICCSSeismogram.data&lt;/code&gt;)" href="#pysmo.tools.iccs.ICCSSeismogram.data">data</a></code></b>
              (<code><a class="autorefs autorefs-external" title="&lt;code&gt;numpy.ndarray&lt;/code&gt;" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>)
          –
          <div class="doc-md-description">
            <p>Seismogram data.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;delta&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-property&quot;&gt;&lt;code&gt;property&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-writable&quot;&gt;&lt;code&gt;writable&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs.ICCSSeismogram.delta&lt;/code&gt;)" href="#pysmo.tools.iccs.ICCSSeismogram.delta">delta</a></code></b>
              (<code><a class="autorefs autorefs-external" title="&lt;code&gt;datetime.timedelta&lt;/code&gt;" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta">timedelta</a></code>)
          –
          <div class="doc-md-description">
            <p>The sampling interval.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;end_time&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-property&quot;&gt;&lt;code&gt;property&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs.ICCSSeismogram.end_time&lt;/code&gt;)" href="#pysmo.tools.iccs.ICCSSeismogram.end_time">end_time</a></code></b>
              (<code><a class="autorefs autorefs-external" title="&lt;code&gt;datetime.datetime&lt;/code&gt;" href="https://docs.python.org/3/library/datetime.html#datetime.datetime">datetime</a></code>)
          –
          <div class="doc-md-description">
            <p>Seismogram end time.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;flip&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-property&quot;&gt;&lt;code&gt;property&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-writable&quot;&gt;&lt;code&gt;writable&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs.ICCSSeismogram.flip&lt;/code&gt;)" href="#pysmo.tools.iccs.ICCSSeismogram.flip">flip</a></code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>)
          –
          <div class="doc-md-description">
            <p>Data in seismogram should be flipped for ICCS.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;select&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-property&quot;&gt;&lt;code&gt;property&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-writable&quot;&gt;&lt;code&gt;writable&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs.ICCSSeismogram.select&lt;/code&gt;)" href="#pysmo.tools.iccs.ICCSSeismogram.select">select</a></code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>)
          –
          <div class="doc-md-description">
            <p>Use seismogram to create stack.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;t0&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-property&quot;&gt;&lt;code&gt;property&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-writable&quot;&gt;&lt;code&gt;writable&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs.ICCSSeismogram.t0&lt;/code&gt;)" href="#pysmo.tools.iccs.ICCSSeismogram.t0">t0</a></code></b>
              (<code><a class="autorefs autorefs-external" title="&lt;code&gt;datetime.datetime&lt;/code&gt;" href="https://docs.python.org/3/library/datetime.html#datetime.datetime">datetime</a></code>)
          –
          <div class="doc-md-description">
            <p>Initial pick.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;t1&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-property&quot;&gt;&lt;code&gt;property&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-writable&quot;&gt;&lt;code&gt;writable&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs.ICCSSeismogram.t1&lt;/code&gt;)" href="#pysmo.tools.iccs.ICCSSeismogram.t1">t1</a></code></b>
              (<code><a class="autorefs autorefs-external" title="&lt;code&gt;datetime.datetime&lt;/code&gt;" href="https://docs.python.org/3/library/datetime.html#datetime.datetime">datetime</a> | None</code>)
          –
          <div class="doc-md-description">
            <p>Updated pick.</p>
          </div>
        </li>
    </ul>

              <details class="quote">
                <summary>Source code in <code>pysmo/tools/iccs/_types.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@runtime_checkable</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ICCSSeismogram</span><span class="p">(</span><span class="n">Seismogram</span><span class="p">,</span> <span class="n">Protocol</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Protocol class to define the `ICCSSeismogram` type.</span>

<span class="sd">    The `ICCSSeismogram` type extends the [`Seismogram`][pysmo.Seismogram] type</span>
<span class="sd">    with the addition of parameters that are required for ICCS.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">flip</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Data in seismogram should be flipped for ICCS.&quot;&quot;&quot;</span>
        <span class="o">...</span>

    <span class="nd">@flip</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">flip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">select</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Use seismogram to create stack.&quot;&quot;&quot;</span>
        <span class="o">...</span>

    <span class="nd">@select</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">t0</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initial pick.&quot;&quot;&quot;</span>
        <span class="o">...</span>

    <span class="nd">@t0</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">t0</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">datetime</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">t1</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Updated pick.&quot;&quot;&quot;</span>
        <span class="o">...</span>

    <span class="nd">@t1</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">t1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">|</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span> <span class="o">...</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="pysmo.tools.iccs.ICCSSeismogram.begin_time" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">begin_time</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

<a href="#pysmo.tools.iccs.ICCSSeismogram.begin_time" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">begin_time</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;datetime.datetime&lt;/code&gt;" href="https://docs.python.org/3/library/datetime.html#datetime.datetime">datetime</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Seismogram begin time.</p>

          
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="pysmo.tools.iccs.ICCSSeismogram.data" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">data</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

<a href="#pysmo.tools.iccs.ICCSSeismogram.data" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">data</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;numpy.ndarray&lt;/code&gt;" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Seismogram data.</p>

          
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="pysmo.tools.iccs.ICCSSeismogram.delta" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">delta</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

<a href="#pysmo.tools.iccs.ICCSSeismogram.delta" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">delta</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;datetime.timedelta&lt;/code&gt;" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta">timedelta</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>The sampling interval.</p>

          
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="pysmo.tools.iccs.ICCSSeismogram.end_time" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">end_time</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#pysmo.tools.iccs.ICCSSeismogram.end_time" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">end_time</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;datetime.datetime&lt;/code&gt;" href="https://docs.python.org/3/library/datetime.html#datetime.datetime">datetime</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Seismogram end time.</p>

          
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="pysmo.tools.iccs.ICCSSeismogram.flip" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">flip</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

<a href="#pysmo.tools.iccs.ICCSSeismogram.flip" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">flip</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Data in seismogram should be flipped for ICCS.</p>

          
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="pysmo.tools.iccs.ICCSSeismogram.select" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">select</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

<a href="#pysmo.tools.iccs.ICCSSeismogram.select" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">select</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Use seismogram to create stack.</p>

          
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="pysmo.tools.iccs.ICCSSeismogram.t0" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">t0</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

<a href="#pysmo.tools.iccs.ICCSSeismogram.t0" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">t0</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;datetime.datetime&lt;/code&gt;" href="https://docs.python.org/3/library/datetime.html#datetime.datetime">datetime</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Initial pick.</p>

          
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="pysmo.tools.iccs.ICCSSeismogram.t1" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">t1</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

<a href="#pysmo.tools.iccs.ICCSSeismogram.t1" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">t1</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;datetime.datetime&lt;/code&gt;" href="https://docs.python.org/3/library/datetime.html#datetime.datetime">datetime</a></span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Updated pick.</p>

          
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="pysmo.tools.iccs.ICCSSeismogram.__len__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">__len__</span>


<a href="#pysmo.tools.iccs.ICCSSeismogram.__len__" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">__len__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>The length of the Seismogram.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
          –
          <div class="doc-md-description">
            <p>Number of samples in the data array.</p>
          </div>
        </li>
    </ul>

          

            <details class="quote">
              <summary>Source code in <code>pysmo/_types/_seismogram.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The length of the Seismogram.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Number of samples in the data array.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pysmo.tools.iccs.MiniICCSSeismogram" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">MiniICCSSeismogram</span>


<a href="#pysmo.tools.iccs.MiniICCSSeismogram" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">


        <p>Minimal implementation of the <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ICCSSeismogram&lt;/span&gt;" href="#pysmo.tools.iccs.ICCSSeismogram"><code>ICCSSeismogram</code></a> type.</p>
<p>The <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ICCSSeismogram&lt;/span&gt;" href="#pysmo.tools.iccs.ICCSSeismogram"><code>MiniICCSSeismogram</code></a> class provides
a minimal implementation of class that is compatible with the
<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ICCSSeismogram&lt;/span&gt;" href="#pysmo.tools.iccs.ICCSSeismogram"><code>ICCSSeismogram</code></a>.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Because <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ICCSSeismogram&lt;/span&gt;" href="#pysmo.tools.iccs.ICCSSeismogram"><code>ICCSSeismogram</code></a> inherits
from <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;Seismogram&lt;/span&gt;" href="../../../#pysmo.Seismogram"><code>Seismogram</code></a>, we can easily create
<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;MiniICCSSeismogram&lt;/span&gt;" href="#pysmo.tools.iccs.MiniICCSSeismogram"><code>MiniICCSSeismogram</code></a> instances
from exisiting seismograms using the
<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-function&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;clone_to_mini&lt;/span&gt;" href="../../functions/#pysmo.functions.clone_to_mini"><code>clone_to_mini()</code></a> function, whereby
the <code>update</code> parameter is used to provide the extra information needed:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">pysmo.classes</span><span class="w"> </span><span class="kn">import</span> <span class="n">SAC</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">pysmo.functions</span><span class="w"> </span><span class="kn">import</span> <span class="n">clone_to_mini</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">pysmo.tools.iccs</span><span class="w"> </span><span class="kn">import</span> <span class="n">MiniICCSSeismogram</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sac</span> <span class="o">=</span> <span class="n">SAC</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;example.sac&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sac_seis</span> <span class="o">=</span> <span class="n">sac</span><span class="o">.</span><span class="n">seismogram</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">update</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;t0&quot;</span><span class="p">:</span> <span class="n">sac</span><span class="o">.</span><span class="n">timestamps</span><span class="o">.</span><span class="n">t0</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">mini_iccs_seis</span> <span class="o">=</span> <span class="n">clone_to_mini</span><span class="p">(</span><span class="n">MiniICCSSeismogram</span><span class="p">,</span> <span class="n">sac_seis</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="n">update</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
</code></pre></div>

          









<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;__len__&lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs.MiniICCSSeismogram.__len__&lt;/code&gt;)" href="#pysmo.tools.iccs.MiniICCSSeismogram.__len__">__len__</a></code></b>
            –
            <div class="doc-md-description">
              <p>The length of the Seismogram.</p>
            </div>
          </li>
    </ul>




<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;begin_time&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs.MiniICCSSeismogram.begin_time&lt;/code&gt;)" href="#pysmo.tools.iccs.MiniICCSSeismogram.begin_time">begin_time</a></code></b>
              (<code><a class="autorefs autorefs-external" title="&lt;code&gt;datetime.datetime&lt;/code&gt;" href="https://docs.python.org/3/library/datetime.html#datetime.datetime">datetime</a></code>)
          –
          <div class="doc-md-description">
            <p>Seismogram begin time.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;data&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs.MiniICCSSeismogram.data&lt;/code&gt;)" href="#pysmo.tools.iccs.MiniICCSSeismogram.data">data</a></code></b>
              (<code><a class="autorefs autorefs-external" title="&lt;code&gt;numpy.ndarray&lt;/code&gt;" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>)
          –
          <div class="doc-md-description">
            <p>Seismogram data.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;delta&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs.MiniICCSSeismogram.delta&lt;/code&gt;)" href="#pysmo.tools.iccs.MiniICCSSeismogram.delta">delta</a></code></b>
              (<code><a class="autorefs autorefs-external" title="&lt;code&gt;datetime.timedelta&lt;/code&gt;" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta">timedelta</a></code>)
          –
          <div class="doc-md-description">
            <p>Seismogram sampling interval.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;end_time&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-property&quot;&gt;&lt;code&gt;property&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs.MiniICCSSeismogram.end_time&lt;/code&gt;)" href="#pysmo.tools.iccs.MiniICCSSeismogram.end_time">end_time</a></code></b>
              (<code><a class="autorefs autorefs-external" title="&lt;code&gt;datetime.datetime&lt;/code&gt;" href="https://docs.python.org/3/library/datetime.html#datetime.datetime">datetime</a></code>)
          –
          <div class="doc-md-description">
            <p>Seismogram end time.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;flip&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs.MiniICCSSeismogram.flip&lt;/code&gt;)" href="#pysmo.tools.iccs.MiniICCSSeismogram.flip">flip</a></code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>)
          –
          <div class="doc-md-description">
            <p>Data in seismogram should be flipped for ICCS.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;select&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs.MiniICCSSeismogram.select&lt;/code&gt;)" href="#pysmo.tools.iccs.MiniICCSSeismogram.select">select</a></code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>)
          –
          <div class="doc-md-description">
            <p>Use seismogram to create stack.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;t0&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs.MiniICCSSeismogram.t0&lt;/code&gt;)" href="#pysmo.tools.iccs.MiniICCSSeismogram.t0">t0</a></code></b>
              (<code><a class="autorefs autorefs-external" title="&lt;code&gt;datetime.datetime&lt;/code&gt;" href="https://docs.python.org/3/library/datetime.html#datetime.datetime">datetime</a></code>)
          –
          <div class="doc-md-description">
            <p>Initial pick.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;t1&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs.MiniICCSSeismogram.t1&lt;/code&gt;)" href="#pysmo.tools.iccs.MiniICCSSeismogram.t1">t1</a></code></b>
              (<code><a class="autorefs autorefs-external" title="&lt;code&gt;datetime.datetime&lt;/code&gt;" href="https://docs.python.org/3/library/datetime.html#datetime.datetime">datetime</a> | None</code>)
          –
          <div class="doc-md-description">
            <p>Updated pick.</p>
          </div>
        </li>
    </ul>

              <details class="quote">
                <summary>Source code in <code>pysmo/tools/iccs/_types.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@define</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">slots</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MiniICCSSeismogram</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Minimal implementation of the [`ICCSSeismogram`][pysmo.tools.iccs.ICCSSeismogram] type.</span>

<span class="sd">    The [`MiniICCSSeismogram`][pysmo.tools.iccs.ICCSSeismogram] class provides</span>
<span class="sd">    a minimal implementation of class that is compatible with the</span>
<span class="sd">    [`ICCSSeismogram`][pysmo.tools.iccs.ICCSSeismogram].</span>

<span class="sd">    Examples:</span>
<span class="sd">        Because [`ICCSSeismogram`][pysmo.tools.iccs.ICCSSeismogram] inherits</span>
<span class="sd">        from [`Seismogram`][pysmo.Seismogram], we can easily create</span>
<span class="sd">        [`MiniICCSSeismogram`][pysmo.tools.iccs.MiniICCSSeismogram] instances</span>
<span class="sd">        from exisiting seismograms using the</span>
<span class="sd">        [`clone_to_mini()`][pysmo.functions.clone_to_mini] function, whereby</span>
<span class="sd">        the `update` parameter is used to provide the extra information needed:</span>

<span class="sd">        ```python</span>
<span class="sd">        &gt;&gt;&gt; from pysmo.classes import SAC</span>
<span class="sd">        &gt;&gt;&gt; from pysmo.functions import clone_to_mini</span>
<span class="sd">        &gt;&gt;&gt; from pysmo.tools.iccs import MiniICCSSeismogram</span>
<span class="sd">        &gt;&gt;&gt; sac = SAC.from_file(&quot;example.sac&quot;)</span>
<span class="sd">        &gt;&gt;&gt; sac_seis = sac.seismogram</span>
<span class="sd">        &gt;&gt;&gt; update = {&quot;t0&quot;: sac.timestamps.t0}</span>
<span class="sd">        &gt;&gt;&gt; mini_iccs_seis = clone_to_mini(MiniICCSSeismogram, sac_seis, update=update)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">begin_time</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="n">SEISMOGRAM_DEFAULTS</span><span class="o">.</span><span class="n">begin_time</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">validator</span><span class="o">=</span><span class="n">datetime_is_utc</span>
    <span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Seismogram begin time.&quot;&quot;&quot;</span>

    <span class="n">delta</span><span class="p">:</span> <span class="n">timedelta</span> <span class="o">=</span> <span class="n">SEISMOGRAM_DEFAULTS</span><span class="o">.</span><span class="n">delta</span><span class="o">.</span><span class="n">value</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Seismogram sampling interval.&quot;&quot;&quot;</span>

    <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]))</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Seismogram data.&quot;&quot;&quot;</span>

    <span class="n">t0</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">validator</span><span class="o">=</span><span class="n">datetime_is_utc</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initial pick.&quot;&quot;&quot;</span>

    <span class="n">t1</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">validator</span><span class="o">=</span><span class="n">validators</span><span class="o">.</span><span class="n">optional</span><span class="p">(</span><span class="n">datetime_is_utc</span><span class="p">)</span>
    <span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Updated pick.&quot;&quot;&quot;</span>

    <span class="n">flip</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Data in seismogram should be flipped for ICCS.&quot;&quot;&quot;</span>

    <span class="n">select</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Use seismogram to create stack.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The length of the Seismogram.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Number of samples in the data array.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">end_time</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Seismogram end time.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">begin_time</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">begin_time</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="pysmo.tools.iccs.MiniICCSSeismogram.begin_time" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">begin_time</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#pysmo.tools.iccs.MiniICCSSeismogram.begin_time" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">begin_time</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;datetime.datetime&lt;/code&gt;" href="https://docs.python.org/3/library/datetime.html#datetime.datetime">datetime</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;attrs.field&lt;/code&gt;" href="https://attrs.org/en/stable/api.html#attrs.field">field</a></span><span class="p">(</span>
    <span class="n"><span title="attrs.field(default)">default</span></span><span class="o">=</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;begin_time&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pysmo.lib.defaults.SEISMOGRAM_DEFAULTS.begin_time&lt;/code&gt;)" href="../../lib/#pysmo.lib.defaults.SEISMOGRAM_DEFAULTS.begin_time">begin_time</a></span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n"><span title="attrs.field(validator)">validator</span></span><span class="o">=</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-function&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;datetime_is_utc&lt;/span&gt; (&lt;code&gt;pysmo.lib.validators.datetime_is_utc&lt;/code&gt;)" href="../../lib/#pysmo.lib.validators.datetime_is_utc">datetime_is_utc</a></span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Seismogram begin time.</p>

          
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="pysmo.tools.iccs.MiniICCSSeismogram.data" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">data</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#pysmo.tools.iccs.MiniICCSSeismogram.data" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">data</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;numpy.ndarray&lt;/code&gt;" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;attrs.field&lt;/code&gt;" href="https://attrs.org/en/stable/api.html#attrs.field">field</a></span><span class="p">(</span><span class="n"><span title="attrs.field(factory)">factory</span></span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;numpy.array&lt;/code&gt;" href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array">array</a></span><span class="p">([]))</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Seismogram data.</p>

          
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="pysmo.tools.iccs.MiniICCSSeismogram.delta" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">delta</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#pysmo.tools.iccs.MiniICCSSeismogram.delta" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">delta</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;datetime.timedelta&lt;/code&gt;" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta">timedelta</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;delta&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;pysmo.lib.defaults.SEISMOGRAM_DEFAULTS.delta&lt;/code&gt;)" href="../../lib/#pysmo.lib.defaults.SEISMOGRAM_DEFAULTS.delta">delta</a></span><span class="o">.</span><span class="n">value</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Seismogram sampling interval.</p>

          
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="pysmo.tools.iccs.MiniICCSSeismogram.end_time" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">end_time</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#pysmo.tools.iccs.MiniICCSSeismogram.end_time" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">end_time</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;datetime.datetime&lt;/code&gt;" href="https://docs.python.org/3/library/datetime.html#datetime.datetime">datetime</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Seismogram end time.</p>

          
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="pysmo.tools.iccs.MiniICCSSeismogram.flip" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">flip</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#pysmo.tools.iccs.MiniICCSSeismogram.flip" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">flip</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Data in seismogram should be flipped for ICCS.</p>

          
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="pysmo.tools.iccs.MiniICCSSeismogram.select" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">select</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#pysmo.tools.iccs.MiniICCSSeismogram.select" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">select</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Use seismogram to create stack.</p>

          
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="pysmo.tools.iccs.MiniICCSSeismogram.t0" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">t0</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#pysmo.tools.iccs.MiniICCSSeismogram.t0" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">t0</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;datetime.datetime&lt;/code&gt;" href="https://docs.python.org/3/library/datetime.html#datetime.datetime">datetime</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;attrs.field&lt;/code&gt;" href="https://attrs.org/en/stable/api.html#attrs.field">field</a></span><span class="p">(</span><span class="n"><span title="attrs.field(validator)">validator</span></span><span class="o">=</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-function&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;datetime_is_utc&lt;/span&gt; (&lt;code&gt;pysmo.lib.validators.datetime_is_utc&lt;/code&gt;)" href="../../lib/#pysmo.lib.validators.datetime_is_utc">datetime_is_utc</a></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Initial pick.</p>

          
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="pysmo.tools.iccs.MiniICCSSeismogram.t1" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">t1</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#pysmo.tools.iccs.MiniICCSSeismogram.t1" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">t1</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;datetime.datetime&lt;/code&gt;" href="https://docs.python.org/3/library/datetime.html#datetime.datetime">datetime</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;attrs.field&lt;/code&gt;" href="https://attrs.org/en/stable/api.html#attrs.field">field</a></span><span class="p">(</span>
    <span class="n"><span title="attrs.field(default)">default</span></span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n"><span title="attrs.field(validator)">validator</span></span><span class="o">=</span><span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;attrs.validators.optional&lt;/code&gt;" href="https://attrs.org/en/stable/api.html#attrs.validators.optional">optional</a></span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-function&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;datetime_is_utc&lt;/span&gt; (&lt;code&gt;pysmo.lib.validators.datetime_is_utc&lt;/code&gt;)" href="../../lib/#pysmo.lib.validators.datetime_is_utc">datetime_is_utc</a></span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Updated pick.</p>

          
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="pysmo.tools.iccs.MiniICCSSeismogram.__len__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">__len__</span>


<a href="#pysmo.tools.iccs.MiniICCSSeismogram.__len__" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">__len__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>The length of the Seismogram.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
          –
          <div class="doc-md-description">
            <p>Number of samples in the data array.</p>
          </div>
        </li>
    </ul>

          

            <details class="quote">
              <summary>Source code in <code>pysmo/tools/iccs/_types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The length of the Seismogram.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Number of samples in the data array.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="pysmo.tools.iccs.plot_seismograms" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">plot_seismograms</span>


<a href="#pysmo.tools.iccs.plot_seismograms" class="headerlink" title="Permanent link">#</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">plot_seismograms</span><span class="p">(</span>
    <span class="n">iccs</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ICCS&lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs._iccs.ICCS&lt;/code&gt;)" href="#pysmo.tools.iccs.ICCS">ICCS</a></span><span class="p">,</span>
    <span class="n">padded</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="nb">all</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">return_fig</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;matplotlib.figure.Figure&lt;/code&gt;" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure">Figure</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;matplotlib.axes.Axes&lt;/code&gt;" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes">Axes</a></span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Plot the selected ICCS seismograms as an image.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>iccs</code></b>
              (<code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ICCS&lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs._iccs.ICCS&lt;/code&gt;)" href="#pysmo.tools.iccs.ICCS">ICCS</a></code>)
          –
          <div class="doc-md-description">
            <p>Instance of the <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ICCS&lt;/span&gt;" href="#pysmo.tools.iccs.ICCS"><code>ICCS</code></a> class.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>padded</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>If True, the plot is padded on both sides of the
time window by the amount defined in
<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;plot_padding&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#pysmo.tools.iccs.ICCS.plot_padding"><code>ICCS.plot_padding</code></a>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>all</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>If <code>True</code>, all seismograms are shown in the plot instead of the
selected ones only.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>return_fig</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>If <code>True</code>, the <a class="autorefs autorefs-external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure"><code>Figure</code></a> and
<a class="autorefs autorefs-external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes"><code>Axes</code></a> objects are returned instead of
shown.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-external" title="&lt;code&gt;matplotlib.figure.Figure&lt;/code&gt;" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure">Figure</a>, <a class="autorefs autorefs-external" title="&lt;code&gt;matplotlib.axes.Axes&lt;/code&gt;" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes">Axes</a>] | None</code>
          –
          <div class="doc-md-description">
            <p>Figure of the selected seismograms as an image if <code>return_fig</code> is <code>True</code>.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <p>The default plotting mode is to pad the seismgorams beyond the time
window used for the cross-correlations. This is particularly useful
for narrow time windows.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">pysmo.tools.iccs</span><span class="w"> </span><span class="kn">import</span> <span class="n">ICCS</span><span class="p">,</span> <span class="n">plot_seismograms</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">iccs</span> <span class="o">=</span> <span class="n">ICCS</span><span class="p">(</span><span class="n">iccs_seismograms</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">_</span> <span class="o">=</span> <span class="n">iccs</span><span class="p">(</span><span class="n">autoselect</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">autoflip</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plot_seismograms</span><span class="p">(</span><span class="n">iccs</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
</code></pre></div>
<!-- invisible-code-block: python
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">if</span> <span class="n">savedir</span><span class="p">:</span>
<span class="o">...</span>     <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;dark_background&quot;</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">plot_seismograms</span><span class="p">(</span><span class="n">iccs</span><span class="p">,</span> <span class="n">return_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savedir</span> <span class="o">/</span> <span class="s2">&quot;iccs_plot_seismograms_padded-dark.png&quot;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">...</span>
<span class="o">...</span>     <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">plot_seismograms</span><span class="p">(</span><span class="n">iccs</span><span class="p">,</span> <span class="n">return_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savedir</span> <span class="o">/</span> <span class="s2">&quot;iccs_plot_seismograms_padded.png&quot;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
</code></pre></div>
-->

<p><img alt="View the seismograms with padding" loading="lazy" src="../../../../examples/figures/iccs_plot_seismograms_padded.png#only-light" />
<img alt="View the seismograms with padding" loading="lazy" src="../../../../examples/figures/iccs_plot_seismograms_padded-dark.png#only-dark" /></p>
<p>To view the seismograms exactly as they are used in the
cross-correlations, set the <code>padded</code> argument to <code>False</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">plot_seismograms</span><span class="p">(</span><span class="n">iccs</span><span class="p">,</span> <span class="n">padded</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
</code></pre></div>
<!-- invisible-code-block: python
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">if</span> <span class="n">savedir</span><span class="p">:</span>
<span class="o">...</span>     <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;dark_background&quot;</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">plot_seismograms</span><span class="p">(</span><span class="n">iccs</span><span class="p">,</span> <span class="n">padded</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savedir</span> <span class="o">/</span> <span class="s2">&quot;iccs_plot_seismograms-dark.png&quot;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">...</span>
<span class="o">...</span>     <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">plot_seismograms</span><span class="p">(</span><span class="n">iccs</span><span class="p">,</span> <span class="n">padded</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savedir</span> <span class="o">/</span> <span class="s2">&quot;iccs_plot_seismograms.png&quot;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
</code></pre></div>
-->

<p><img alt="View the seismograms with padding" loading="lazy" src="../../../../examples/figures/iccs_plot_seismograms.png#only-light" />
<img alt="View the seismograms with padding" loading="lazy" src="../../../../examples/figures/iccs_plot_seismograms-dark.png#only-dark" /></p>

          

            <details class="quote">
              <summary>Source code in <code>pysmo/tools/iccs/_functions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_seismograms</span><span class="p">(</span>
    <span class="n">iccs</span><span class="p">:</span> <span class="n">ICCS</span><span class="p">,</span> <span class="n">padded</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="nb">all</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">return_fig</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Figure</span><span class="p">,</span> <span class="n">Axes</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot the selected ICCS seismograms as an image.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        iccs: Instance of the [`ICCS`][pysmo.tools.iccs.ICCS] class.</span>
<span class="sd">        padded: If True, the plot is padded on both sides of the</span>
<span class="sd">            time window by the amount defined in</span>
<span class="sd">            [`ICCS.plot_padding`][pysmo.tools.iccs.ICCS.plot_padding].</span>
<span class="sd">        all: If `True`, all seismograms are shown in the plot instead of the</span>
<span class="sd">            selected ones only.</span>
<span class="sd">        return_fig: If `True`, the [`Figure`][matplotlib.figure.Figure] and</span>
<span class="sd">            [`Axes`][matplotlib.axes.Axes] objects are returned instead of</span>
<span class="sd">            shown.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Figure of the selected seismograms as an image if `return_fig` is `True`.</span>

<span class="sd">    Examples:</span>
<span class="sd">        The default plotting mode is to pad the seismgorams beyond the time</span>
<span class="sd">        window used for the cross-correlations. This is particularly useful</span>
<span class="sd">        for narrow time windows.</span>

<span class="sd">        ```python</span>
<span class="sd">        &gt;&gt;&gt; from pysmo.tools.iccs import ICCS, plot_seismograms</span>
<span class="sd">        &gt;&gt;&gt; iccs = ICCS(iccs_seismograms)</span>
<span class="sd">        &gt;&gt;&gt; _ = iccs(autoselect=True, autoflip=True)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; plot_seismograms(iccs)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        ```</span>

<span class="sd">        &lt;!-- invisible-code-block: python</span>
<span class="sd">        ```</span>
<span class="sd">        &gt;&gt;&gt; import matplotlib.pyplot as plt</span>
<span class="sd">        &gt;&gt;&gt; plt.close(&quot;all&quot;)</span>
<span class="sd">        &gt;&gt;&gt; if savedir:</span>
<span class="sd">        ...     plt.style.use(&quot;dark_background&quot;)</span>
<span class="sd">        ...     fig, _ = plot_seismograms(iccs, return_fig=True)</span>
<span class="sd">        ...     fig.savefig(savedir / &quot;iccs_plot_seismograms_padded-dark.png&quot;, transparent=True)</span>
<span class="sd">        ...</span>
<span class="sd">        ...     plt.style.use(&quot;default&quot;)</span>
<span class="sd">        ...     fig, _ = plot_seismograms(iccs, return_fig=True)</span>
<span class="sd">        ...     fig.savefig(savedir / &quot;iccs_plot_seismograms_padded.png&quot;, transparent=True)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        ```</span>
<span class="sd">        --&gt;</span>

<span class="sd">        ![View the seismograms with padding](../../../examples/figures/iccs_plot_seismograms_padded.png#only-light){ loading=lazy }</span>
<span class="sd">        ![View the seismograms with padding](../../../examples/figures/iccs_plot_seismograms_padded-dark.png#only-dark){ loading=lazy }</span>

<span class="sd">        To view the seismograms exactly as they are used in the</span>
<span class="sd">        cross-correlations, set the `padded` argument to `False`:</span>

<span class="sd">        ```python</span>
<span class="sd">        &gt;&gt;&gt; plot_seismograms(iccs, padded=False)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        ```</span>

<span class="sd">        &lt;!-- invisible-code-block: python</span>
<span class="sd">        ```</span>
<span class="sd">        &gt;&gt;&gt; import matplotlib.pyplot as plt</span>
<span class="sd">        &gt;&gt;&gt; plt.close(&quot;all&quot;)</span>
<span class="sd">        &gt;&gt;&gt; if savedir:</span>
<span class="sd">        ...     plt.style.use(&quot;dark_background&quot;)</span>
<span class="sd">        ...     fig, _ = plot_seismograms(iccs, padded=False, return_fig=True)</span>
<span class="sd">        ...     fig.savefig(savedir / &quot;iccs_plot_seismograms-dark.png&quot;, transparent=True)</span>
<span class="sd">        ...</span>
<span class="sd">        ...     plt.style.use(&quot;default&quot;)</span>
<span class="sd">        ...     fig, _ = plot_seismograms(iccs, padded=False, return_fig=True)</span>
<span class="sd">        ...     fig.savefig(savedir / &quot;iccs_plot_seismograms.png&quot;, transparent=True)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        ```</span>
<span class="sd">        --&gt;</span>

<span class="sd">        ![View the seismograms with padding](../../../examples/figures/iccs_plot_seismograms.png#only-light){ loading=lazy }</span>
<span class="sd">        ![View the seismograms with padding](../../../examples/figures/iccs_plot_seismograms-dark.png#only-dark){ loading=lazy }</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">_plot_common_image</span><span class="p">(</span><span class="n">iccs</span><span class="p">,</span> <span class="n">padded</span><span class="p">,</span> <span class="nb">all</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">return_fig</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pysmo.tools.iccs.plot_stack" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">plot_stack</span>


<a href="#pysmo.tools.iccs.plot_stack" class="headerlink" title="Permanent link">#</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">plot_stack</span><span class="p">(</span>
    <span class="n">iccs</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ICCS&lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs._iccs.ICCS&lt;/code&gt;)" href="#pysmo.tools.iccs.ICCS">ICCS</a></span><span class="p">,</span>
    <span class="n">padded</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="nb">all</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">return_fig</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;matplotlib.figure.Figure&lt;/code&gt;" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure">Figure</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;matplotlib.axes.Axes&lt;/code&gt;" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes">Axes</a></span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Plot the ICCS stack.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>iccs</code></b>
              (<code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ICCS&lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs._iccs.ICCS&lt;/code&gt;)" href="#pysmo.tools.iccs.ICCS">ICCS</a></code>)
          –
          <div class="doc-md-description">
            <p>Instance of the <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ICCS&lt;/span&gt;" href="#pysmo.tools.iccs.ICCS"><code>ICCS</code></a> class.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>padded</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>If True, the plot is padded on both sides of the
time window by the amount defined in
<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;plot_padding&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#pysmo.tools.iccs.ICCS.plot_padding"><code>ICCS.plot_padding</code></a>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>all</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>If <code>True</code>, all seismograms are shown in the plot instead of the
selected ones only.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>return_fig</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>If <code>True</code>, the <a class="autorefs autorefs-external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure"><code>Figure</code></a> and
<a class="autorefs autorefs-external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes"><code>Axes</code></a> objects are returned instead of
shown.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-external" title="&lt;code&gt;matplotlib.figure.Figure&lt;/code&gt;" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure">Figure</a>, <a class="autorefs autorefs-external" title="&lt;code&gt;matplotlib.axes.Axes&lt;/code&gt;" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes">Axes</a>] | None</code>
          –
          <div class="doc-md-description">
            <p>Figure of the stack with the seismograms if <code>return_fig</code> is <code>True</code>.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <p>The default plotting mode is to pad the stack beyond the time window
used for the cross-correlations (highlighted in light green). This is
useful particularly useful for narrow time windows. Note that because
of the padding, the displayed stack isn't exactly what is used for the
cross-correlations.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">pysmo.tools.iccs</span><span class="w"> </span><span class="kn">import</span> <span class="n">ICCS</span><span class="p">,</span> <span class="n">plot_stack</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">iccs</span> <span class="o">=</span> <span class="n">ICCS</span><span class="p">(</span><span class="n">iccs_seismograms</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">_</span> <span class="o">=</span> <span class="n">iccs</span><span class="p">(</span><span class="n">autoselect</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">autoflip</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plot_stack</span><span class="p">(</span><span class="n">iccs</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
</code></pre></div>
<!-- invisible-code-block: python
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">if</span> <span class="n">savedir</span><span class="p">:</span>
<span class="o">...</span>     <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;dark_background&quot;</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">plot_stack</span><span class="p">(</span><span class="n">iccs</span><span class="p">,</span> <span class="n">return_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savedir</span> <span class="o">/</span> <span class="s2">&quot;iccs_view_stack_padded-dark.png&quot;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">...</span>
<span class="o">...</span>     <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">plot_stack</span><span class="p">(</span><span class="n">iccs</span><span class="p">,</span> <span class="n">return_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savedir</span> <span class="o">/</span> <span class="s2">&quot;iccs_view_stack_padded.png&quot;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
</code></pre></div>
-->

<p><img alt="View the stack with padding" loading="lazy" src="../../../../examples/figures/iccs_view_stack_padded.png#only-light" />
<img alt="View the stack with padding" loading="lazy" src="../../../../examples/figures/iccs_view_stack_padded-dark.png#only-dark" /></p>
<p>To view the stack exactly as it is used in the cross-correlations, set
the <code>padded</code> argument to <code>False</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">plot_stack</span><span class="p">(</span><span class="n">iccs</span><span class="p">,</span> <span class="n">padded</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
</code></pre></div>
<!-- invisible-code-block: python
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">if</span> <span class="n">savedir</span><span class="p">:</span>
<span class="o">...</span>     <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;dark_background&quot;</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">plot_stack</span><span class="p">(</span><span class="n">iccs</span><span class="p">,</span> <span class="n">padded</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savedir</span> <span class="o">/</span> <span class="s2">&quot;iccs_view_stack-dark.png&quot;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">...</span>
<span class="o">...</span>     <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">plot_stack</span><span class="p">(</span><span class="n">iccs</span><span class="p">,</span> <span class="n">padded</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savedir</span> <span class="o">/</span> <span class="s2">&quot;iccs_view_stack.png&quot;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
</code></pre></div>
-->

<p><img alt="View the stack with padding" loading="lazy" src="../../../../examples/figures/iccs_view_stack.png#only-light" />
<img alt="View the stack with padding" loading="lazy" src="../../../../examples/figures/iccs_view_stack-dark.png#only-dark" /></p>

          

            <details class="quote">
              <summary>Source code in <code>pysmo/tools/iccs/_functions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_stack</span><span class="p">(</span>
    <span class="n">iccs</span><span class="p">:</span> <span class="n">ICCS</span><span class="p">,</span> <span class="n">padded</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="nb">all</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">return_fig</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Figure</span><span class="p">,</span> <span class="n">Axes</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot the ICCS stack.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        iccs: Instance of the [`ICCS`][pysmo.tools.iccs.ICCS] class.</span>
<span class="sd">        padded: If True, the plot is padded on both sides of the</span>
<span class="sd">            time window by the amount defined in</span>
<span class="sd">            [`ICCS.plot_padding`][pysmo.tools.iccs.ICCS.plot_padding].</span>
<span class="sd">        all: If `True`, all seismograms are shown in the plot instead of the</span>
<span class="sd">            selected ones only.</span>
<span class="sd">        return_fig: If `True`, the [`Figure`][matplotlib.figure.Figure] and</span>
<span class="sd">            [`Axes`][matplotlib.axes.Axes] objects are returned instead of</span>
<span class="sd">            shown.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Figure of the stack with the seismograms if `return_fig` is `True`.</span>

<span class="sd">    Examples:</span>
<span class="sd">        The default plotting mode is to pad the stack beyond the time window</span>
<span class="sd">        used for the cross-correlations (highlighted in light green). This is</span>
<span class="sd">        useful particularly useful for narrow time windows. Note that because</span>
<span class="sd">        of the padding, the displayed stack isn&#39;t exactly what is used for the</span>
<span class="sd">        cross-correlations.</span>

<span class="sd">        ```python</span>
<span class="sd">        &gt;&gt;&gt; from pysmo.tools.iccs import ICCS, plot_stack</span>
<span class="sd">        &gt;&gt;&gt; iccs = ICCS(iccs_seismograms)</span>
<span class="sd">        &gt;&gt;&gt; _ = iccs(autoselect=True, autoflip=True)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; plot_stack(iccs)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        ```</span>

<span class="sd">        &lt;!-- invisible-code-block: python</span>
<span class="sd">        ```</span>
<span class="sd">        &gt;&gt;&gt; import matplotlib.pyplot as plt</span>
<span class="sd">        &gt;&gt;&gt; plt.close(&quot;all&quot;)</span>
<span class="sd">        &gt;&gt;&gt; if savedir:</span>
<span class="sd">        ...     plt.style.use(&quot;dark_background&quot;)</span>
<span class="sd">        ...     fig, _ = plot_stack(iccs, return_fig=True)</span>
<span class="sd">        ...     fig.savefig(savedir / &quot;iccs_view_stack_padded-dark.png&quot;, transparent=True)</span>
<span class="sd">        ...</span>
<span class="sd">        ...     plt.style.use(&quot;default&quot;)</span>
<span class="sd">        ...     fig, _ = plot_stack(iccs, return_fig=True)</span>
<span class="sd">        ...     fig.savefig(savedir / &quot;iccs_view_stack_padded.png&quot;, transparent=True)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        ```</span>
<span class="sd">        --&gt;</span>

<span class="sd">        ![View the stack with padding](../../../examples/figures/iccs_view_stack_padded.png#only-light){ loading=lazy }</span>
<span class="sd">        ![View the stack with padding](../../../examples/figures/iccs_view_stack_padded-dark.png#only-dark){ loading=lazy }</span>

<span class="sd">        To view the stack exactly as it is used in the cross-correlations, set</span>
<span class="sd">        the `padded` argument to `False`:</span>

<span class="sd">        ```python</span>
<span class="sd">        &gt;&gt;&gt; plot_stack(iccs, padded=False)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        ```</span>

<span class="sd">        &lt;!-- invisible-code-block: python</span>
<span class="sd">        ```</span>
<span class="sd">        &gt;&gt;&gt; import matplotlib.pyplot as plt</span>
<span class="sd">        &gt;&gt;&gt; plt.close(&quot;all&quot;)</span>
<span class="sd">        &gt;&gt;&gt; if savedir:</span>
<span class="sd">        ...     plt.style.use(&quot;dark_background&quot;)</span>
<span class="sd">        ...     fig, _ = plot_stack(iccs, padded=False, return_fig=True)</span>
<span class="sd">        ...     fig.savefig(savedir / &quot;iccs_view_stack-dark.png&quot;, transparent=True)</span>
<span class="sd">        ...</span>
<span class="sd">        ...     plt.style.use(&quot;default&quot;)</span>
<span class="sd">        ...     fig, _ = plot_stack(iccs, padded=False, return_fig=True)</span>
<span class="sd">        ...     fig.savefig(savedir / &quot;iccs_view_stack.png&quot;, transparent=True)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        ```</span>
<span class="sd">        --&gt;</span>

<span class="sd">        ![View the stack with padding](../../../examples/figures/iccs_view_stack.png#only-light){ loading=lazy }</span>
<span class="sd">        ![View the stack with padding](../../../examples/figures/iccs_view_stack-dark.png#only-dark){ loading=lazy }</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">_plot_common_stack</span><span class="p">(</span><span class="n">iccs</span><span class="p">,</span> <span class="n">padded</span><span class="p">,</span> <span class="nb">all</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">return_fig</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pysmo.tools.iccs.update_all_picks" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">update_all_picks</span>


<a href="#pysmo.tools.iccs.update_all_picks" class="headerlink" title="Permanent link">#</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">update_all_picks</span><span class="p">(</span><span class="n">iccs</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ICCS&lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs._iccs.ICCS&lt;/code&gt;)" href="#pysmo.tools.iccs.ICCS">ICCS</a></span><span class="p">,</span> <span class="n">pickdelta</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;datetime.timedelta&lt;/code&gt;" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta">timedelta</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Update <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;t1&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-property&quot;&gt;&lt;code&gt;property&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-writable&quot;&gt;&lt;code&gt;writable&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#pysmo.tools.iccs.ICCSSeismogram.t1"><code>t1</code></a> in all seismograms by the same amount.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>iccs</code></b>
              (<code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ICCS&lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs._iccs.ICCS&lt;/code&gt;)" href="#pysmo.tools.iccs.ICCS">ICCS</a></code>)
          –
          <div class="doc-md-description">
            <p>Instance of the <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ICCS&lt;/span&gt;" href="#pysmo.tools.iccs.ICCS"><code>ICCS</code></a> class.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>pickdelta</code></b>
              (<code><a class="autorefs autorefs-external" title="&lt;code&gt;datetime.timedelta&lt;/code&gt;" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta">timedelta</a></code>)
          –
          <div class="doc-md-description">
            <p>delta applied to all picks.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code>
            –
          <div class="doc-md-description">
            <p>If the new t1 is outside the valid range.</p>
          </div>
        </li>
    </ul>

          

            <details class="quote">
              <summary>Source code in <code>pysmo/tools/iccs/_functions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update_all_picks</span><span class="p">(</span><span class="n">iccs</span><span class="p">:</span> <span class="n">ICCS</span><span class="p">,</span> <span class="n">pickdelta</span><span class="p">:</span> <span class="n">timedelta</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Update [`t1`][pysmo.tools.iccs.ICCSSeismogram.t1] in all seismograms by the same amount.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        iccs: Instance of the [`ICCS`][pysmo.tools.iccs.ICCS] class.</span>
<span class="sd">        pickdelta: delta applied to all picks.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the new t1 is outside the valid range.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">iccs</span><span class="o">.</span><span class="n">validate_pick</span><span class="p">(</span><span class="n">pickdelta</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;New t1 is outside the valid range. Consider reducing the time window.&quot;</span>
        <span class="p">)</span>

    <span class="k">for</span> <span class="n">seismogram</span> <span class="ow">in</span> <span class="n">iccs</span><span class="o">.</span><span class="n">seismograms</span><span class="p">:</span>
        <span class="n">current_pick</span> <span class="o">=</span> <span class="n">seismogram</span><span class="o">.</span><span class="n">t1</span> <span class="ow">or</span> <span class="n">seismogram</span><span class="o">.</span><span class="n">t0</span>
        <span class="n">seismogram</span><span class="o">.</span><span class="n">t1</span> <span class="o">=</span> <span class="n">current_pick</span> <span class="o">+</span> <span class="n">pickdelta</span>
    <span class="n">iccs</span><span class="o">.</span><span class="n">_clear_caches</span><span class="p">()</span>  <span class="c1"># seismograms and stack need to be refreshed</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pysmo.tools.iccs.update_min_ccnorm" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">update_min_ccnorm</span>


<a href="#pysmo.tools.iccs.update_min_ccnorm" class="headerlink" title="Permanent link">#</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">update_min_ccnorm</span><span class="p">(</span>
    <span class="n">iccs</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ICCS&lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs._iccs.ICCS&lt;/code&gt;)" href="#pysmo.tools.iccs.ICCS">ICCS</a></span><span class="p">,</span>
    <span class="n">padded</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="nb">all</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">return_fig</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;matplotlib.figure.Figure&lt;/code&gt;" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure">Figure</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;matplotlib.axes.Axes&lt;/code&gt;" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes">Axes</a></span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Interactively pick a new <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;min_ccnorm&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#pysmo.tools.iccs.ICCS.min_ccnorm"><code>min_ccnorm</code></a>.</p>
<p>This function launches an interactive figure to manually pick a new
<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;min_ccnorm&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#pysmo.tools.iccs.ICCS.min_ccnorm"><code>min_ccnorm</code></a>, which is used when
<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;__call__&lt;/span&gt;" href="#pysmo.tools.iccs.ICCS.__call__">running</a> the ICCS algorithm with
<code>autoselect</code> set to <code>True</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>iccs</code></b>
              (<code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ICCS&lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs._iccs.ICCS&lt;/code&gt;)" href="#pysmo.tools.iccs.ICCS">ICCS</a></code>)
          –
          <div class="doc-md-description">
            <p>Instance of the <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ICCS&lt;/span&gt;" href="#pysmo.tools.iccs.ICCS"><code>ICCS</code></a> class.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>padded</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>If True, the plot is padded on both sides of the
time window by the amount defined in
<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;plot_padding&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#pysmo.tools.iccs.ICCS.plot_padding"><code>ICCS.plot_padding</code></a>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>all</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>If <code>True</code>, all seismograms are shown in the plot instead of the
selected ones only.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>return_fig</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>If <code>True</code>, the <a class="autorefs autorefs-external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure"><code>Figure</code></a> and
<a class="autorefs autorefs-external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes"><code>Axes</code></a> objects are returned instead of
shown.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-external" title="&lt;code&gt;matplotlib.figure.Figure&lt;/code&gt;" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure">Figure</a>, <a class="autorefs autorefs-external" title="&lt;code&gt;matplotlib.axes.Axes&lt;/code&gt;" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes">Axes</a>] | None</code>
          –
          <div class="doc-md-description">
            <p>Figure with the selector if <code>return_fig</code> is <code>True</code>.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">pysmo.tools.iccs</span><span class="w"> </span><span class="kn">import</span> <span class="n">ICCS</span><span class="p">,</span> <span class="n">update_min_ccnorm</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">iccs</span> <span class="o">=</span> <span class="n">ICCS</span><span class="p">(</span><span class="n">iccs_seismograms</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">_</span> <span class="o">=</span> <span class="n">iccs</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">update_min_ccnorm</span><span class="p">(</span><span class="n">iccs</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
</code></pre></div>
<!-- invisible-code-block: python
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">if</span> <span class="n">savedir</span><span class="p">:</span>
<span class="o">...</span>     <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;dark_background&quot;</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">update_min_ccnorm</span><span class="p">(</span><span class="n">iccs</span><span class="p">,</span> <span class="n">return_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savedir</span> <span class="o">/</span> <span class="s2">&quot;iccs_update_min_ccnorm-dark.png&quot;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">...</span>
<span class="o">...</span>     <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">update_min_ccnorm</span><span class="p">(</span><span class="n">iccs</span><span class="p">,</span> <span class="n">return_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savedir</span> <span class="o">/</span> <span class="s2">&quot;iccs_update_min_ccnorm.png&quot;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span>
</code></pre></div>
-->

<p><img alt="Picking a new time window in stack" loading="lazy" src="../../../../examples/figures/iccs_update_min_ccnorm.png#only-light" />
<img alt="Picking a new time window in stack" loading="lazy" src="../../../../examples/figures/iccs_update_min_ccnorm-dark.png#only-dark" /></p>

          

            <details class="quote">
              <summary>Source code in <code>pysmo/tools/iccs/_functions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update_min_ccnorm</span><span class="p">(</span>
    <span class="n">iccs</span><span class="p">:</span> <span class="n">ICCS</span><span class="p">,</span> <span class="n">padded</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="nb">all</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">return_fig</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Figure</span><span class="p">,</span> <span class="n">Axes</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Interactively pick a new [`min_ccnorm`][pysmo.tools.iccs.ICCS.min_ccnorm].</span>

<span class="sd">    This function launches an interactive figure to manually pick a new</span>
<span class="sd">    [`min_ccnorm`][pysmo.tools.iccs.ICCS.min_ccnorm], which is used when</span>
<span class="sd">    [running][pysmo.tools.iccs.ICCS.__call__] the ICCS algorithm with</span>
<span class="sd">    `autoselect` set to `True`.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        iccs: Instance of the [`ICCS`][pysmo.tools.iccs.ICCS] class.</span>
<span class="sd">        padded: If True, the plot is padded on both sides of the</span>
<span class="sd">            time window by the amount defined in</span>
<span class="sd">            [`ICCS.plot_padding`][pysmo.tools.iccs.ICCS.plot_padding].</span>
<span class="sd">        all: If `True`, all seismograms are shown in the plot instead of the</span>
<span class="sd">            selected ones only.</span>
<span class="sd">        return_fig: If `True`, the [`Figure`][matplotlib.figure.Figure] and</span>
<span class="sd">            [`Axes`][matplotlib.axes.Axes] objects are returned instead of</span>
<span class="sd">            shown.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Figure with the selector if `return_fig` is `True`.</span>

<span class="sd">    Examples:</span>
<span class="sd">        ```python</span>
<span class="sd">        &gt;&gt;&gt; from pysmo.tools.iccs import ICCS, update_min_ccnorm</span>
<span class="sd">        &gt;&gt;&gt; iccs = ICCS(iccs_seismograms)</span>
<span class="sd">        &gt;&gt;&gt; _ = iccs()</span>
<span class="sd">        &gt;&gt;&gt; update_min_ccnorm(iccs)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        ```</span>

<span class="sd">        &lt;!-- invisible-code-block: python</span>
<span class="sd">        ```</span>
<span class="sd">        &gt;&gt;&gt; import matplotlib.pyplot as plt</span>
<span class="sd">        &gt;&gt;&gt; plt.close(&quot;all&quot;)</span>
<span class="sd">        &gt;&gt;&gt; if savedir:</span>
<span class="sd">        ...     plt.style.use(&quot;dark_background&quot;)</span>
<span class="sd">        ...     fig, _ = update_min_ccnorm(iccs, return_fig=True)</span>
<span class="sd">        ...     fig.savefig(savedir / &quot;iccs_update_min_ccnorm-dark.png&quot;, transparent=True)</span>
<span class="sd">        ...</span>
<span class="sd">        ...     plt.style.use(&quot;default&quot;)</span>
<span class="sd">        ...     fig, _ = update_min_ccnorm(iccs, return_fig=True)</span>
<span class="sd">        ...     fig.savefig(savedir / &quot;iccs_update_min_ccnorm.png&quot;, transparent=True)</span>
<span class="sd">        ...     plt.close()</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        ```</span>
<span class="sd">        --&gt;</span>

<span class="sd">        ![Picking a new time window in stack](../../../examples/figures/iccs_update_min_ccnorm.png#only-light){ loading=lazy }</span>
<span class="sd">        ![Picking a new time window in stack](../../../examples/figures/iccs_update_min_ccnorm-dark.png#only-dark){ loading=lazy }</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># If the lowest index is chosen in the gui, set the new min_ccnorm to</span>
    <span class="c1"># the lowest value of all seismograms multiplied by a multiplier</span>
    <span class="n">_INDEX_ZERO_MULTIPLIER</span> <span class="o">=</span> <span class="mf">0.9</span>

    <span class="n">current_ccnorms</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
        <span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">iccs</span><span class="o">.</span><span class="n">ccnorms</span><span class="p">,</span> <span class="n">iccs</span><span class="o">.</span><span class="n">seismograms</span><span class="p">)</span> <span class="k">if</span> <span class="n">_</span><span class="o">.</span><span class="n">select</span> <span class="ow">or</span> <span class="nb">all</span>
    <span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">selected_seismogram_matrix</span> <span class="o">=</span> <span class="n">_plot_common_image</span><span class="p">(</span>
        <span class="n">iccs</span><span class="p">,</span> <span class="n">padded</span><span class="p">,</span> <span class="nb">all</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">constrained</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.93</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Pick a new minimal cross-correlation coefficient.&quot;</span><span class="p">)</span>

    <span class="n">start_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">current_ccnorms</span><span class="p">,</span> <span class="n">iccs</span><span class="o">.</span><span class="n">min_ccnorm</span><span class="p">))</span>
    <span class="n">max_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">selected_seismogram_matrix</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="n">pick_line</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">start_index</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">pick_line_cursor</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">start_index</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">snap_ydata</span><span class="p">(</span><span class="n">ydata</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">ydata</span><span class="p">,</span> <span class="n">max_index</span><span class="p">)))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">calc_ccnorm</span><span class="p">(</span><span class="n">pick_line</span><span class="p">:</span> <span class="n">Line2D</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">:</span>
        <span class="c1"># NOTE: the pick_line ydata should already be a round number, but</span>
        <span class="c1"># mypy complains without it.</span>
        <span class="n">index</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">pick_line</span><span class="o">.</span><span class="n">get_ydata</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_INDEX_ZERO_MULTIPLIER</span> <span class="o">*</span> <span class="n">current_ccnorms</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">current_ccnorms</span><span class="p">[</span><span class="n">index</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">onclick</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">MouseEvent</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">inaxes</span> <span class="ow">is</span> <span class="n">ax</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">ydata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ydata</span> <span class="o">=</span> <span class="n">snap_ydata</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">ydata</span><span class="p">)</span>
            <span class="n">pick_line</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">((</span><span class="n">ydata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">))</span>
            <span class="n">pick_line</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">flush_events</span><span class="p">()</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Click save to set min_ccnorm to </span><span class="si">{</span><span class="n">calc_ccnorm</span><span class="p">(</span><span class="n">pick_line</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">on_mouse_move</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">MouseEvent</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">inaxes</span> <span class="ow">is</span> <span class="n">ax</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">ydata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ydata</span> <span class="o">=</span> <span class="n">snap_ydata</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">ydata</span><span class="p">)</span>
            <span class="n">pick_line_cursor</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">((</span><span class="n">ydata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">))</span>
            <span class="n">pick_line_cursor</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pick_line_cursor</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>

    <span class="k">class</span><span class="w"> </span><span class="nc">ScrollIndexTracker</span><span class="p">:</span>
        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">:</span> <span class="n">Axes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scroll_index</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">max_scroll_index</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">on_scroll</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">MouseEvent</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">inaxes</span> <span class="ow">is</span> <span class="n">ax</span><span class="p">:</span>
                <span class="n">increment</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scroll_index</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">button</span> <span class="o">==</span> <span class="s2">&quot;up&quot;</span>
                    <span class="k">else</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scroll_index</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scroll_index</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
                    <span class="mi">1</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_scroll_index</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scroll_index</span> <span class="o">+</span> <span class="n">increment</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scroll_index</span><span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>

    <span class="k">class</span><span class="w"> </span><span class="nc">SaveOrCancel</span><span class="p">:</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">Event</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">iccs</span><span class="o">.</span><span class="n">min_ccnorm</span> <span class="o">=</span> <span class="n">calc_ccnorm</span><span class="p">(</span><span class="n">pick_line</span><span class="p">)</span>
            <span class="n">iccs</span><span class="o">.</span><span class="n">_clear_caches</span><span class="p">()</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">Event</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">_</span> <span class="o">=</span> <span class="n">Cursor</span><span class="p">(</span>
        <span class="n">ax</span><span class="p">,</span>
        <span class="n">useblit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">vertOn</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">horizOn</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">callback</span> <span class="o">=</span> <span class="n">SaveOrCancel</span><span class="p">()</span>
    <span class="n">ax_save</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">((</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.075</span><span class="p">))</span>
    <span class="n">ax_cancel</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">((</span><span class="mf">0.81</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.075</span><span class="p">))</span>
    <span class="n">b_save</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="n">ax_save</span><span class="p">,</span> <span class="s2">&quot;Save&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkgreen&quot;</span><span class="p">,</span> <span class="n">hovercolor</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
    <span class="n">b_save</span><span class="o">.</span><span class="n">on_clicked</span><span class="p">(</span><span class="n">callback</span><span class="o">.</span><span class="n">save</span><span class="p">)</span>
    <span class="n">b_abort</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="n">ax_cancel</span><span class="p">,</span> <span class="s2">&quot;Cancel&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkred&quot;</span><span class="p">,</span> <span class="n">hovercolor</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
    <span class="n">b_abort</span><span class="o">.</span><span class="n">on_clicked</span><span class="p">(</span><span class="n">callback</span><span class="o">.</span><span class="n">cancel</span><span class="p">)</span>
    <span class="n">tracker</span> <span class="o">=</span> <span class="n">ScrollIndexTracker</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

    <span class="n">_</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">mpl_connect</span><span class="p">(</span><span class="s2">&quot;scroll_event&quot;</span><span class="p">,</span> <span class="n">tracker</span><span class="o">.</span><span class="n">on_scroll</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">mpl_connect</span><span class="p">(</span><span class="s2">&quot;button_press_event&quot;</span><span class="p">,</span> <span class="n">onclick</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">mpl_connect</span><span class="p">(</span><span class="s2">&quot;motion_notify_event&quot;</span><span class="p">,</span> <span class="n">on_mouse_move</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="k">if</span> <span class="n">return_fig</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pysmo.tools.iccs.update_pick" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">update_pick</span>


<a href="#pysmo.tools.iccs.update_pick" class="headerlink" title="Permanent link">#</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">update_pick</span><span class="p">(</span>
    <span class="n">iccs</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ICCS&lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs._iccs.ICCS&lt;/code&gt;)" href="#pysmo.tools.iccs.ICCS">ICCS</a></span><span class="p">,</span>
    <span class="n">padded</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="nb">all</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">use_seismogram_image</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">return_fig</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;matplotlib.figure.Figure&lt;/code&gt;" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure">Figure</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;matplotlib.axes.Axes&lt;/code&gt;" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes">Axes</a></span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Manually pick <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;t1&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-property&quot;&gt;&lt;code&gt;property&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-writable&quot;&gt;&lt;code&gt;writable&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#pysmo.tools.iccs.ICCSSeismogram.t1"><code>t1</code></a> and apply it to all seismograms.</p>
<p>This function launches an interactive figure to manually pick a new phase
arrival, and then apply it to all seismograms.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>iccs</code></b>
              (<code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ICCS&lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs._iccs.ICCS&lt;/code&gt;)" href="#pysmo.tools.iccs.ICCS">ICCS</a></code>)
          –
          <div class="doc-md-description">
            <p>Instance of the <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ICCS&lt;/span&gt;" href="#pysmo.tools.iccs.ICCS"><code>ICCS</code></a> class.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>padded</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>If True, the plot is padded on both sides of the
time window by the amount defined in
<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;plot_padding&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#pysmo.tools.iccs.ICCS.plot_padding"><code>ICCS.plot_padding</code></a>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>all</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>If <code>True</code>, all seismograms are shown in the plot instead of the
selected ones only.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>use_seismogram_image</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>Use the
<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-function&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;plot_seismograms&lt;/span&gt;" href="#pysmo.tools.iccs.plot_seismograms">seismogram image</a>
instead of the <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-function&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;plot_stack&lt;/span&gt;" href="#pysmo.tools.iccs.plot_stack">stack</a>).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>return_fig</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>If <code>True</code>, the <a class="autorefs autorefs-external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure"><code>Figure</code></a> and
<a class="autorefs autorefs-external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes"><code>Axes</code></a> objects are returned instead of
shown.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-external" title="&lt;code&gt;matplotlib.figure.Figure&lt;/code&gt;" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure">Figure</a>, <a class="autorefs autorefs-external" title="&lt;code&gt;matplotlib.axes.Axes&lt;/code&gt;" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes">Axes</a>] | None</code>
          –
          <div class="doc-md-description">
            <p>Figure of the stack with the picker if <code>return_fig</code> is <code>True</code>.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">pysmo.tools.iccs</span><span class="w"> </span><span class="kn">import</span> <span class="n">ICCS</span><span class="p">,</span> <span class="n">update_pick</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">iccs</span> <span class="o">=</span> <span class="n">ICCS</span><span class="p">(</span><span class="n">iccs_seismograms</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">_</span> <span class="o">=</span> <span class="n">iccs</span><span class="p">(</span><span class="n">autoselect</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">autoflip</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">update_pick</span><span class="p">(</span><span class="n">iccs</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
</code></pre></div>
<!-- invisible-code-block: python
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">if</span> <span class="n">savedir</span><span class="p">:</span>
<span class="o">...</span>     <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;dark_background&quot;</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">update_pick</span><span class="p">(</span><span class="n">iccs</span><span class="p">,</span> <span class="n">return_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savedir</span> <span class="o">/</span> <span class="s2">&quot;iccs_update_pick-dark.png&quot;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">...</span>
<span class="o">...</span>     <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">update_pick</span><span class="p">(</span><span class="n">iccs</span><span class="p">,</span> <span class="n">return_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savedir</span> <span class="o">/</span> <span class="s2">&quot;iccs_update_pick.png&quot;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
</code></pre></div>
-->

<p><img alt="Picking a new T1" loading="lazy" src="../../../../examples/figures/iccs_update_pick.png#only-light" />
<img alt="Picking a new T1" loading="lazy" src="../../../../examples/figures/iccs_update_pick-dark.png#only-dark" /></p>

          

            <details class="quote">
              <summary>Source code in <code>pysmo/tools/iccs/_functions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update_pick</span><span class="p">(</span>
    <span class="n">iccs</span><span class="p">:</span> <span class="n">ICCS</span><span class="p">,</span>
    <span class="n">padded</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="nb">all</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">use_seismogram_image</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">return_fig</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Figure</span><span class="p">,</span> <span class="n">Axes</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Manually pick [`t1`][pysmo.tools.iccs.ICCSSeismogram.t1] and apply it to all seismograms.</span>

<span class="sd">    This function launches an interactive figure to manually pick a new phase</span>
<span class="sd">    arrival, and then apply it to all seismograms.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        iccs: Instance of the [`ICCS`][pysmo.tools.iccs.ICCS] class.</span>
<span class="sd">        padded: If True, the plot is padded on both sides of the</span>
<span class="sd">            time window by the amount defined in</span>
<span class="sd">            [`ICCS.plot_padding`][pysmo.tools.iccs.ICCS.plot_padding].</span>
<span class="sd">        all: If `True`, all seismograms are shown in the plot instead of the</span>
<span class="sd">            selected ones only.</span>
<span class="sd">        use_seismogram_image: Use the</span>
<span class="sd">            [seismogram image][pysmo.tools.iccs.plot_seismograms]</span>
<span class="sd">            instead of the [stack][pysmo.tools.iccs.plot_stack]).</span>
<span class="sd">        return_fig: If `True`, the [`Figure`][matplotlib.figure.Figure] and</span>
<span class="sd">            [`Axes`][matplotlib.axes.Axes] objects are returned instead of</span>
<span class="sd">            shown.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Figure of the stack with the picker if `return_fig` is `True`.</span>

<span class="sd">    Examples:</span>
<span class="sd">        ```python</span>
<span class="sd">        &gt;&gt;&gt; from pysmo.tools.iccs import ICCS, update_pick</span>
<span class="sd">        &gt;&gt;&gt; iccs = ICCS(iccs_seismograms)</span>
<span class="sd">        &gt;&gt;&gt; _ = iccs(autoselect=True, autoflip=True)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; update_pick(iccs)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        ```</span>

<span class="sd">        &lt;!-- invisible-code-block: python</span>
<span class="sd">        ```</span>
<span class="sd">        &gt;&gt;&gt; import matplotlib.pyplot as plt</span>
<span class="sd">        &gt;&gt;&gt; plt.close(&quot;all&quot;)</span>
<span class="sd">        &gt;&gt;&gt; if savedir:</span>
<span class="sd">        ...     plt.style.use(&quot;dark_background&quot;)</span>
<span class="sd">        ...     fig, _ = update_pick(iccs, return_fig=True)</span>
<span class="sd">        ...     fig.savefig(savedir / &quot;iccs_update_pick-dark.png&quot;, transparent=True)</span>
<span class="sd">        ...</span>
<span class="sd">        ...     plt.style.use(&quot;default&quot;)</span>
<span class="sd">        ...     fig, _ = update_pick(iccs, return_fig=True)</span>
<span class="sd">        ...     fig.savefig(savedir / &quot;iccs_update_pick.png&quot;, transparent=True)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        ```</span>
<span class="sd">        --&gt;</span>

<span class="sd">        ![Picking a new T1](../../../examples/figures/iccs_update_pick.png#only-light){ loading=lazy }</span>
<span class="sd">        ![Picking a new T1](../../../examples/figures/iccs_update_pick-dark.png#only-dark){ loading=lazy }</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">use_seismogram_image</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">_plot_common_image</span><span class="p">(</span>
            <span class="n">iccs</span><span class="p">,</span> <span class="n">padded</span><span class="p">,</span> <span class="nb">all</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">constrained</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.93</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">_plot_common_stack</span><span class="p">(</span>
            <span class="n">iccs</span><span class="p">,</span> <span class="n">padded</span><span class="p">,</span> <span class="nb">all</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">constrained</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.09</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.93</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Update t1 for all seismograms.&quot;</span><span class="p">)</span>

    <span class="n">pick_line</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">cursor</span> <span class="o">=</span> <span class="n">Cursor</span><span class="p">(</span>  <span class="c1"># noqa: F841</span>
        <span class="n">ax</span><span class="p">,</span> <span class="n">useblit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">horizOn</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span>
    <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">onclick</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">MouseEvent</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">event</span><span class="o">.</span><span class="n">inaxes</span> <span class="ow">is</span> <span class="n">ax</span>
            <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">xdata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="n">iccs</span><span class="o">.</span><span class="n">validate_pick</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">event</span><span class="o">.</span><span class="n">xdata</span><span class="p">))</span>
        <span class="p">):</span>
            <span class="n">pick_line</span><span class="o">.</span><span class="n">set_xdata</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">event</span><span class="o">.</span><span class="n">xdata</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">xdata</span><span class="p">)))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Click save to adjust t1 by </span><span class="si">{</span><span class="n">event</span><span class="o">.</span><span class="n">xdata</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> seconds.&quot;</span><span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">flush_events</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">on_mouse_move</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">MouseEvent</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">inaxes</span> <span class="o">==</span> <span class="n">ax</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">xdata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">iccs</span><span class="o">.</span><span class="n">validate_pick</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">event</span><span class="o">.</span><span class="n">xdata</span><span class="p">)):</span>
                <span class="n">cursor</span><span class="o">.</span><span class="n">linev</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">&quot;g&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cursor</span><span class="o">.</span><span class="n">linev</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>

    <span class="k">class</span><span class="w"> </span><span class="nc">SaveOrCancel</span><span class="p">:</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">Event</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pickdelta</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">pick_line</span><span class="o">.</span><span class="n">get_xdata</span><span class="p">(</span><span class="n">orig</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># type: ignore</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">update_all_picks</span><span class="p">(</span><span class="n">iccs</span><span class="p">,</span> <span class="n">pickdelta</span><span class="p">)</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">Event</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">callback</span> <span class="o">=</span> <span class="n">SaveOrCancel</span><span class="p">()</span>
    <span class="n">ax_save</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">((</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.075</span><span class="p">))</span>
    <span class="n">ax_cancel</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">((</span><span class="mf">0.81</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.075</span><span class="p">))</span>
    <span class="n">b_save</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="n">ax_save</span><span class="p">,</span> <span class="s2">&quot;Save&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkgreen&quot;</span><span class="p">,</span> <span class="n">hovercolor</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
    <span class="n">b_save</span><span class="o">.</span><span class="n">on_clicked</span><span class="p">(</span><span class="n">callback</span><span class="o">.</span><span class="n">save</span><span class="p">)</span>
    <span class="n">b_abort</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="n">ax_cancel</span><span class="p">,</span> <span class="s2">&quot;Cancel&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkred&quot;</span><span class="p">,</span> <span class="n">hovercolor</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
    <span class="n">b_abort</span><span class="o">.</span><span class="n">on_clicked</span><span class="p">(</span><span class="n">callback</span><span class="o">.</span><span class="n">cancel</span><span class="p">)</span>

    <span class="n">_</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">mpl_connect</span><span class="p">(</span><span class="s2">&quot;button_press_event&quot;</span><span class="p">,</span> <span class="n">onclick</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="n">_</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">mpl_connect</span><span class="p">(</span><span class="s2">&quot;motion_notify_event&quot;</span><span class="p">,</span> <span class="n">on_mouse_move</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="k">if</span> <span class="n">return_fig</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pysmo.tools.iccs.update_timewindow" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">update_timewindow</span>


<a href="#pysmo.tools.iccs.update_timewindow" class="headerlink" title="Permanent link">#</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">update_timewindow</span><span class="p">(</span>
    <span class="n">iccs</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ICCS&lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs._iccs.ICCS&lt;/code&gt;)" href="#pysmo.tools.iccs.ICCS">ICCS</a></span><span class="p">,</span>
    <span class="n">padded</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="nb">all</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">use_seismogram_image</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">return_fig</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;matplotlib.figure.Figure&lt;/code&gt;" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure">Figure</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;matplotlib.axes.Axes&lt;/code&gt;" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes">Axes</a></span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Pick new time window limits.</p>
<p>This function launches an interactive figure to pick new values for
<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;window_pre&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#pysmo.tools.iccs.ICCS.window_pre"><code>window_pre</code></a> and
<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;window_post&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#pysmo.tools.iccs.ICCS.window_post"><code>window_post</code></a>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>iccs</code></b>
              (<code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ICCS&lt;/span&gt; (&lt;code&gt;pysmo.tools.iccs._iccs.ICCS&lt;/code&gt;)" href="#pysmo.tools.iccs.ICCS">ICCS</a></code>)
          –
          <div class="doc-md-description">
            <p>Instance of the <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ICCS&lt;/span&gt;" href="#pysmo.tools.iccs.ICCS"><code>ICCS</code></a> class.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>padded</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>If True, the plot is padded on both sides of the
time window by the amount defined in
<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;plot_padding&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt;" href="#pysmo.tools.iccs.ICCS.plot_padding"><code>ICCS.plot_padding</code></a>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>all</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>If <code>True</code>, all seismograms are shown in the plot instead of the
selected ones only.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>use_seismogram_image</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>Use the
<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-function&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;plot_seismograms&lt;/span&gt;" href="#pysmo.tools.iccs.plot_seismograms">seismogram image</a>
instead of the <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-function&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;plot_stack&lt;/span&gt;" href="#pysmo.tools.iccs.plot_stack">stack</a>).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>return_fig</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>If <code>True</code>, the <a class="autorefs autorefs-external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure"><code>Figure</code></a> and
<a class="autorefs autorefs-external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes"><code>Axes</code></a> objects are returned instead of
shown.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-external" title="&lt;code&gt;matplotlib.figure.Figure&lt;/code&gt;" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure">Figure</a>, <a class="autorefs autorefs-external" title="&lt;code&gt;matplotlib.axes.Axes&lt;/code&gt;" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes">Axes</a>] | None</code>
          –
          <div class="doc-md-description">
            <p>Figure of the stack with the picker if <code>return_fig</code> is <code>True</code>.</p>
          </div>
        </li>
    </ul>


<details class="info" open>
  <summary>Info</summary>
  <p>The new time window may not be chosen such that the pick lies
outside the the window. The picker will therefore automatically correct
itself for invalid window choices.</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">pysmo.tools.iccs</span><span class="w"> </span><span class="kn">import</span> <span class="n">ICCS</span><span class="p">,</span> <span class="n">update_timewindow</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">iccs</span> <span class="o">=</span> <span class="n">ICCS</span><span class="p">(</span><span class="n">iccs_seismograms</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">_</span> <span class="o">=</span> <span class="n">iccs</span><span class="p">(</span><span class="n">autoselect</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">autoflip</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">update_timewindow</span><span class="p">(</span><span class="n">iccs</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
</code></pre></div>
<!-- invisible-code-block: python
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">if</span> <span class="n">savedir</span><span class="p">:</span>
<span class="o">...</span>     <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;dark_background&quot;</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">update_timewindow</span><span class="p">(</span><span class="n">iccs</span><span class="p">,</span> <span class="n">return_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savedir</span> <span class="o">/</span> <span class="s2">&quot;iccs_update_timewindow-dark.png&quot;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">...</span>
<span class="o">...</span>     <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">update_timewindow</span><span class="p">(</span><span class="n">iccs</span><span class="p">,</span> <span class="n">return_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savedir</span> <span class="o">/</span> <span class="s2">&quot;iccs_update_timewindow.png&quot;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
</code></pre></div>
-->

<p><img alt="Picking a new time window" loading="lazy" src="../../../../examples/figures/iccs_update_timewindow.png#only-light" />
<img alt="Picking a new time window" loading="lazy" src="../../../../examples/figures/iccs_update_timewindow-dark.png#only-dark" /></p>

          

            <details class="quote">
              <summary>Source code in <code>pysmo/tools/iccs/_functions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update_timewindow</span><span class="p">(</span>
    <span class="n">iccs</span><span class="p">:</span> <span class="n">ICCS</span><span class="p">,</span>
    <span class="n">padded</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="nb">all</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">use_seismogram_image</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">return_fig</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Figure</span><span class="p">,</span> <span class="n">Axes</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Pick new time window limits.</span>

<span class="sd">    This function launches an interactive figure to pick new values for</span>
<span class="sd">    [`window_pre`][pysmo.tools.iccs.ICCS.window_pre] and</span>
<span class="sd">    [`window_post`][pysmo.tools.iccs.ICCS.window_post].</span>

<span class="sd">    Parameters:</span>
<span class="sd">        iccs: Instance of the [`ICCS`][pysmo.tools.iccs.ICCS] class.</span>
<span class="sd">        padded: If True, the plot is padded on both sides of the</span>
<span class="sd">            time window by the amount defined in</span>
<span class="sd">            [`ICCS.plot_padding`][pysmo.tools.iccs.ICCS.plot_padding].</span>
<span class="sd">        all: If `True`, all seismograms are shown in the plot instead of the</span>
<span class="sd">            selected ones only.</span>
<span class="sd">        use_seismogram_image: Use the</span>
<span class="sd">            [seismogram image][pysmo.tools.iccs.plot_seismograms]</span>
<span class="sd">            instead of the [stack][pysmo.tools.iccs.plot_stack]).</span>
<span class="sd">        return_fig: If `True`, the [`Figure`][matplotlib.figure.Figure] and</span>
<span class="sd">            [`Axes`][matplotlib.axes.Axes] objects are returned instead of</span>
<span class="sd">            shown.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Figure of the stack with the picker if `return_fig` is `True`.</span>

<span class="sd">    Info:</span>
<span class="sd">        The new time window may not be chosen such that the pick lies</span>
<span class="sd">        outside the the window. The picker will therefore automatically correct</span>
<span class="sd">        itself for invalid window choices.</span>

<span class="sd">    Examples:</span>
<span class="sd">        ```python</span>
<span class="sd">        &gt;&gt;&gt; from pysmo.tools.iccs import ICCS, update_timewindow</span>
<span class="sd">        &gt;&gt;&gt; iccs = ICCS(iccs_seismograms)</span>
<span class="sd">        &gt;&gt;&gt; _ = iccs(autoselect=True, autoflip=True)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; update_timewindow(iccs)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        ```</span>

<span class="sd">        &lt;!-- invisible-code-block: python</span>
<span class="sd">        ```</span>
<span class="sd">        &gt;&gt;&gt; import matplotlib.pyplot as plt</span>
<span class="sd">        &gt;&gt;&gt; plt.close(&quot;all&quot;)</span>
<span class="sd">        &gt;&gt;&gt; if savedir:</span>
<span class="sd">        ...     plt.style.use(&quot;dark_background&quot;)</span>
<span class="sd">        ...     fig, _ = update_timewindow(iccs, return_fig=True)</span>
<span class="sd">        ...     fig.savefig(savedir / &quot;iccs_update_timewindow-dark.png&quot;, transparent=True)</span>
<span class="sd">        ...</span>
<span class="sd">        ...     plt.style.use(&quot;default&quot;)</span>
<span class="sd">        ...     fig, _ = update_timewindow(iccs, return_fig=True)</span>
<span class="sd">        ...     fig.savefig(savedir / &quot;iccs_update_timewindow.png&quot;, transparent=True)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        ```</span>
<span class="sd">        --&gt;</span>

<span class="sd">        ![Picking a new time window](../../../examples/figures/iccs_update_timewindow.png#only-light){ loading=lazy }</span>
<span class="sd">        ![Picking a new time window](../../../examples/figures/iccs_update_timewindow-dark.png#only-dark){ loading=lazy }</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">use_seismogram_image</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">_plot_common_image</span><span class="p">(</span>
            <span class="n">iccs</span><span class="p">,</span> <span class="n">padded</span><span class="p">,</span> <span class="nb">all</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">constrained</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.93</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">_plot_common_stack</span><span class="p">(</span>
            <span class="n">iccs</span><span class="p">,</span> <span class="n">padded</span><span class="p">,</span> <span class="nb">all</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">constrained</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.09</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.93</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Pick a new time window.&quot;</span><span class="p">)</span>

    <span class="c1"># &#39;old_extents&#39; is used to revert to the last valid extents</span>
    <span class="n">old_extents</span> <span class="o">=</span> <span class="p">(</span><span class="n">iccs</span><span class="o">.</span><span class="n">window_pre</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">(),</span> <span class="n">iccs</span><span class="o">.</span><span class="n">window_post</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">())</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">onselect</span><span class="p">(</span><span class="n">xmin</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">xmax</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">nonlocal</span> <span class="n">old_extents</span>
        <span class="k">if</span> <span class="n">iccs</span><span class="o">.</span><span class="n">validate_time_window</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">xmin</span><span class="p">),</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">xmax</span><span class="p">)):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Click save to set window at </span><span class="si">{</span><span class="n">xmin</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">xmax</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> seconds.&quot;</span>
            <span class="p">)</span>
            <span class="n">old_extents</span> <span class="o">=</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="n">span</span><span class="o">.</span><span class="n">extents</span> <span class="o">=</span> <span class="n">old_extents</span>

    <span class="n">span</span> <span class="o">=</span> <span class="n">SpanSelector</span><span class="p">(</span>
        <span class="n">ax</span><span class="p">,</span>
        <span class="n">onselect</span><span class="p">,</span>
        <span class="s2">&quot;horizontal&quot;</span><span class="p">,</span>
        <span class="n">useblit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">props</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;tab:blue&quot;</span><span class="p">),</span>
        <span class="n">interactive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">drag_from_anywhere</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Set the initial extents to the existing time window</span>
    <span class="n">span</span><span class="o">.</span><span class="n">extents</span> <span class="o">=</span> <span class="n">old_extents</span>

    <span class="k">class</span><span class="w"> </span><span class="nc">SaveOrCancel</span><span class="p">:</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">Event</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">iccs</span><span class="o">.</span><span class="n">window_pre</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">span</span><span class="o">.</span><span class="n">extents</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">iccs</span><span class="o">.</span><span class="n">window_post</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">span</span><span class="o">.</span><span class="n">extents</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">Event</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">callback</span> <span class="o">=</span> <span class="n">SaveOrCancel</span><span class="p">()</span>
    <span class="n">ax_save</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">((</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.075</span><span class="p">))</span>
    <span class="n">ax_cancel</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">((</span><span class="mf">0.81</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.075</span><span class="p">))</span>
    <span class="n">b_save</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="n">ax_save</span><span class="p">,</span> <span class="s2">&quot;Save&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkgreen&quot;</span><span class="p">,</span> <span class="n">hovercolor</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
    <span class="n">b_save</span><span class="o">.</span><span class="n">on_clicked</span><span class="p">(</span><span class="n">callback</span><span class="o">.</span><span class="n">save</span><span class="p">)</span>
    <span class="n">b_abort</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="n">ax_cancel</span><span class="p">,</span> <span class="s2">&quot;Cancel&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkred&quot;</span><span class="p">,</span> <span class="n">hovercolor</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
    <span class="n">b_abort</span><span class="o">.</span><span class="n">on_clicked</span><span class="p">(</span><span class="n">callback</span><span class="o">.</span><span class="n">cancel</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">return_fig</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../azdist/" class="md-footer__link md-footer__link--prev" aria-label="Previous: azdist">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                azdist
              </div>
            </div>
          </a>
        
        
          
          <a href="../noise/" class="md-footer__link md-footer__link--next" aria-label="Next: noise">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                noise
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2012 - 2025 Simon Lloyd
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../..", "features": ["content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tooltips", "content.tabs.link", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.top"], "search": "../../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../../../javascripts/katex.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/katex.min.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/contrib/auto-render.min.js"></script>
      
        <script src="../../../../termynal.js"></script>
      
    
  </body>
</html>